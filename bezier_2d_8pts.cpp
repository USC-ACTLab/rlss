#include <cmath>
#include <vector>
#include "bezier_mathematica.h"
#include <iostream>
using namespace std;


vector<double> bezier_gradient_2d_8pts(double a, double b, vector<vectoreuc>& R, double dur) {
  return vector<double> {(7*pow(a,2)*pow(dur,13)*R[0][0] - 7*pow(b,2)*pow(dur,13)*R[0][0] - 2*a*pow(dur,14)*R[0][0] + 2*b*pow(dur,14)*R[0][0] + 7*pow(a,2)*pow(dur,13)*(R[0][0] - R[1][0]) -
      7*pow(b,2)*pow(dur,13)*(R[0][0] - R[1][0]) - (7*pow(a,3)*pow(dur,12)*(26*R[0][0] - 26*R[1][0] + 6*R[2][0]))/3. + (7*pow(b,3)*pow(dur,12)*(26*R[0][0] - 26*R[1][0] + 6*R[2][0]))/3. +
      (7*pow(a,4)*pow(dur,11)*(52*R[0][0] - 78*R[1][0] + 36*R[2][0] - 5*R[3][0]))/2. - (7*pow(b,4)*pow(dur,11)*(52*R[0][0] - 78*R[1][0] + 36*R[2][0] - 5*R[3][0]))/2. -
      (7*pow(a,5)*pow(dur,10)*(286*R[0][0] - 2*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. + (7*pow(b,5)*pow(dur,10)*(286*R[0][0] - 2*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. +
      (7*pow(a,6)*pow(dur,9)*(286*R[0][0] - 715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0]))/3. -
      (7*pow(b,6)*pow(dur,9)*(286*R[0][0] - 715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0]))/3. +
      pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
      pow(a,7)*pow(dur,8)*(858*R[0][0] + 2*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) +
      pow(b,7)*pow(dur,8)*(858*R[0][0] + 2*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) +
      (7*pow(a,12)*pow(dur,3)*(52*R[0][0] - 286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(52*R[0][0] - 286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]))/6. +
      (7*pow(a,10)*pow(dur,5)*(286*R[0][0] - 1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]))/5. -
      (7*pow(b,10)*pow(dur,5)*(286*R[0][0] - 1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]))/5. -
      (2*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
      (2*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
      pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
      pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
      (pow(a,8)*pow(dur,7)*(3432*R[0][0] - 12012*R[1][0] + 16632*R[2][0] - 11550*R[3][0] + 4200*R[4][0] - 756*R[5][0] + 56*R[6][0] - R[7][0]))/4. -
      (pow(b,8)*pow(dur,7)*(3432*R[0][0] - 12012*R[1][0] + 16632*R[2][0] - 11550*R[3][0] + 4200*R[4][0] - 756*R[5][0] + 56*R[6][0] - R[7][0]))/4. -
      (7*pow(a,9)*pow(dur,6)*(858*R[0][0] - 2*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. +
      (7*pow(b,9)*pow(dur,6)*(858*R[0][0] - 2*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. -
      (7*pow(a,13)*pow(dur,2)*(26*R[0][0] - 2*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. +
      (7*pow(b,13)*pow(dur,2)*(26*R[0][0] - 2*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. -
      (7*pow(a,11)*pow(dur,4)*(286*R[0][0] - 2*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11. +
      (7*pow(b,11)*pow(dur,4)*(286*R[0][0] - 2*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11.)/pow(dur,14),
   (7*pow(a,2)*pow(dur,13)*R[0][1] - 7*pow(b,2)*pow(dur,13)*R[0][1] - 2*a*pow(dur,14)*R[0][1] + 2*b*pow(dur,14)*R[0][1] + 7*pow(a,2)*pow(dur,13)*(R[0][1] - R[1][1]) -
      7*pow(b,2)*pow(dur,13)*(R[0][1] - R[1][1]) - (7*pow(a,3)*pow(dur,12)*(26*R[0][1] - 26*R[1][1] + 6*R[2][1]))/3. + (7*pow(b,3)*pow(dur,12)*(26*R[0][1] - 26*R[1][1] + 6*R[2][1]))/3. +
      (7*pow(a,4)*pow(dur,11)*(52*R[0][1] - 78*R[1][1] + 36*R[2][1] - 5*R[3][1]))/2. - (7*pow(b,4)*pow(dur,11)*(52*R[0][1] - 78*R[1][1] + 36*R[2][1] - 5*R[3][1]))/2. -
      (7*pow(a,5)*pow(dur,10)*(286*R[0][1] - 2*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. + (7*pow(b,5)*pow(dur,10)*(286*R[0][1] - 2*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. +
      (7*pow(a,6)*pow(dur,9)*(286*R[0][1] - 715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1]))/3. -
      (7*pow(b,6)*pow(dur,9)*(286*R[0][1] - 715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1]))/3. +
      pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
      pow(a,7)*pow(dur,8)*(858*R[0][1] + 2*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
      pow(b,7)*pow(dur,8)*(858*R[0][1] + 2*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
      (7*pow(a,12)*pow(dur,3)*(52*R[0][1] - 286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(52*R[0][1] - 286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]))/6. +
      (7*pow(a,10)*pow(dur,5)*(286*R[0][1] - 1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]))/5. -
      (7*pow(b,10)*pow(dur,5)*(286*R[0][1] - 1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]))/5. -
      (2*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
      (2*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
      pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
      pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
      (pow(a,8)*pow(dur,7)*(3432*R[0][1] - 12012*R[1][1] + 16632*R[2][1] - 11550*R[3][1] + 4200*R[4][1] - 756*R[5][1] + 56*R[6][1] - R[7][1]))/4. -
      (pow(b,8)*pow(dur,7)*(3432*R[0][1] - 12012*R[1][1] + 16632*R[2][1] - 11550*R[3][1] + 4200*R[4][1] - 756*R[5][1] + 56*R[6][1] - R[7][1]))/4. -
      (7*pow(a,9)*pow(dur,6)*(858*R[0][1] - 2*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. +
      (7*pow(b,9)*pow(dur,6)*(858*R[0][1] - 2*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. -
      (7*pow(a,13)*pow(dur,2)*(26*R[0][1] - 2*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. +
      (7*pow(b,13)*pow(dur,2)*(26*R[0][1] - 2*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. -
      (7*pow(a,11)*pow(dur,4)*(286*R[0][1] - 2*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11. +
      (7*pow(b,11)*pow(dur,4)*(286*R[0][1] - 2*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11.)/pow(dur,14),
   (-7*pow(a,2)*pow(dur,13)*R[0][0] + 7*pow(b,2)*pow(dur,13)*R[0][0] - (7*pow(a,3)*pow(dur,12)*(-26*R[0][0] + 14*R[1][0]))/3. + (7*pow(b,3)*pow(dur,12)*(-26*R[0][0] + 14*R[1][0]))/3. +
      (7*pow(a,4)*pow(dur,11)*(-78*R[0][0] + 42*R[1][0] + 21*(2*R[1][0] - R[2][0])))/2. - (7*pow(b,4)*pow(dur,11)*(-78*R[0][0] + 42*R[1][0] + 21*(2*R[1][0] - R[2][0])))/2. -
      (7*pow(a,5)*pow(dur,10)*(-572*R[0][0] + 7*(132*R[1][0] - 66*R[2][0] + 10*R[3][0])))/5. + (7*pow(b,5)*pow(dur,10)*(-572*R[0][0] + 7*(132*R[1][0] - 66*R[2][0] + 10*R[3][0])))/5. +
      (7*pow(a,6)*pow(dur,9)*(-715*R[0][0] + 35*(44*R[1][0] - 33*R[2][0] + 10*R[3][0] - R[4][0])))/3. - (7*pow(b,6)*pow(dur,9)*(-715*R[0][0] + 35*(44*R[1][0] - 33*R[2][0] + 10*R[3][0] - R[4][0])))/3. -
      pow(a,7)*pow(dur,8)*(-2574*R[0][0] + 7*(990*R[1][0] + 6*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0]))) +
      pow(b,7)*pow(dur,8)*(-2574*R[0][0] + 7*(990*R[1][0] + 6*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0]))) +
      (pow(a,8)*pow(dur,7)*(-12012*R[0][0] + 49*(792*R[1][0] - 990*R[2][0] + 600*R[3][0] - 180*R[4][0] + 24*R[5][0] - R[6][0])))/4. -
      (pow(b,8)*pow(dur,7)*(-12012*R[0][0] + 49*(792*R[1][0] - 990*R[2][0] + 600*R[3][0] - 180*R[4][0] + 24*R[5][0] - R[6][0])))/4. -
      7*pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + 7*pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
      (7*pow(a,13)*pow(dur,2)*(-156*R[0][0] + 924*R[1][0] - 6*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0])))/13. +
      (7*pow(b,13)*pow(dur,2)*(-156*R[0][0] + 924*R[1][0] - 6*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0])))/13. -
      (7*pow(a,11)*pow(dur,4)*(-1430*R[0][0] + 6930*R[1][0] - 10*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0])))/11. +
      (7*pow(b,11)*pow(dur,4)*(-1430*R[0][0] + 6930*R[1][0] - 10*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0])))/11. +
      (7*pow(a,10)*pow(dur,5)*(-1287*R[0][0] + 5544*R[1][0] - 3*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0])))/5. -
      (7*pow(b,10)*pow(dur,5)*(-1287*R[0][0] + 5544*R[1][0] - 3*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0])))/5. -
      (7*pow(a,9)*pow(dur,6)*(-3432*R[0][0] + 12936*R[1][0] - 2*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0])))/9. +
      (7*pow(b,9)*pow(dur,6)*(-3432*R[0][0] + 12936*R[1][0] - 2*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0])))/9. +
      (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. -
      (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. -
      6*pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
      6*pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
      (7*pow(a,12)*pow(dur,3)*(-286*R[0][0] + 1540*R[1][0] - 3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(-286*R[0][0] + 1540*R[1][0] - 3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0]))/6.)/pow(dur,14),
   (-7*pow(a,2)*pow(dur,13)*R[0][1] + 7*pow(b,2)*pow(dur,13)*R[0][1] - (7*pow(a,3)*pow(dur,12)*(-26*R[0][1] + 14*R[1][1]))/3. + (7*pow(b,3)*pow(dur,12)*(-26*R[0][1] + 14*R[1][1]))/3. +
      (7*pow(a,4)*pow(dur,11)*(-78*R[0][1] + 42*R[1][1] + 21*(2*R[1][1] - R[2][1])))/2. - (7*pow(b,4)*pow(dur,11)*(-78*R[0][1] + 42*R[1][1] + 21*(2*R[1][1] - R[2][1])))/2. -
      (7*pow(a,5)*pow(dur,10)*(-572*R[0][1] + 7*(132*R[1][1] - 66*R[2][1] + 10*R[3][1])))/5. + (7*pow(b,5)*pow(dur,10)*(-572*R[0][1] + 7*(132*R[1][1] - 66*R[2][1] + 10*R[3][1])))/5. +
      (7*pow(a,6)*pow(dur,9)*(-715*R[0][1] + 35*(44*R[1][1] - 33*R[2][1] + 10*R[3][1] - R[4][1])))/3. - (7*pow(b,6)*pow(dur,9)*(-715*R[0][1] + 35*(44*R[1][1] - 33*R[2][1] + 10*R[3][1] - R[4][1])))/3. -
      pow(a,7)*pow(dur,8)*(-2574*R[0][1] + 7*(990*R[1][1] + 6*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1]))) +
      pow(b,7)*pow(dur,8)*(-2574*R[0][1] + 7*(990*R[1][1] + 6*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1]))) +
      (pow(a,8)*pow(dur,7)*(-12012*R[0][1] + 49*(792*R[1][1] - 990*R[2][1] + 600*R[3][1] - 180*R[4][1] + 24*R[5][1] - R[6][1])))/4. -
      (pow(b,8)*pow(dur,7)*(-12012*R[0][1] + 49*(792*R[1][1] - 990*R[2][1] + 600*R[3][1] - 180*R[4][1] + 24*R[5][1] - R[6][1])))/4. -
      7*pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + 7*pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
      (7*pow(a,13)*pow(dur,2)*(-156*R[0][1] + 924*R[1][1] - 6*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1])))/13. +
      (7*pow(b,13)*pow(dur,2)*(-156*R[0][1] + 924*R[1][1] - 6*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1])))/13. -
      (7*pow(a,11)*pow(dur,4)*(-1430*R[0][1] + 6930*R[1][1] - 10*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1])))/11. +
      (7*pow(b,11)*pow(dur,4)*(-1430*R[0][1] + 6930*R[1][1] - 10*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1])))/11. +
      (7*pow(a,10)*pow(dur,5)*(-1287*R[0][1] + 5544*R[1][1] - 3*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1])))/5. -
      (7*pow(b,10)*pow(dur,5)*(-1287*R[0][1] + 5544*R[1][1] - 3*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1])))/5. -
      (7*pow(a,9)*pow(dur,6)*(-3432*R[0][1] + 12936*R[1][1] - 2*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1])))/9. +
      (7*pow(b,9)*pow(dur,6)*(-3432*R[0][1] + 12936*R[1][1] - 2*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1])))/9. +
      (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. -
      (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. -
      6*pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
      6*pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
      (7*pow(a,12)*pow(dur,3)*(-286*R[0][1] + 1540*R[1][1] - 3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(-286*R[0][1] + 1540*R[1][1] - 3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1]))/6.)/pow(dur,14),
   (-14*pow(a,3)*pow(dur,12)*R[0][0] + 14*pow(b,3)*pow(dur,12)*R[0][0] + (7*pow(a,4)*pow(dur,11)*(36*R[0][0] - 21*R[1][0]))/2. - (7*pow(b,4)*pow(dur,11)*(36*R[0][0] - 21*R[1][0]))/2. -
      (7*pow(a,5)*pow(dur,10)*(396*R[0][0] + 7*(-66*R[1][0] + 18*R[2][0])))/5. + (7*pow(b,5)*pow(dur,10)*(396*R[0][0] + 7*(-66*R[1][0] + 18*R[2][0])))/5. +
      (7*pow(a,6)*pow(dur,9)*(660*R[0][0] + 35*(-33*R[1][0] + 9*R[2][0] + 3*(3*R[2][0] - R[3][0]))))/3. - (7*pow(b,6)*pow(dur,9)*(660*R[0][0] + 35*(-33*R[1][0] + 9*R[2][0] + 3*(3*R[2][0] - R[3][0]))))/3. -
      pow(a,7)*pow(dur,8)*(2970*R[0][0] + 7*(-990*R[1][0] + 5*(162*R[2][0] + 6*(-9*R[3][0] + R[4][0])))) + pow(b,7)*pow(dur,8)*(2970*R[0][0] + 7*(-990*R[1][0] + 5*(162*R[2][0] + 6*(-9*R[3][0] + R[4][0])))) +
      (pow(a,8)*pow(dur,7)*(16632*R[0][0] + 49*(-990*R[1][0] + 1080*R[2][0] - 3*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]))))/4. -
      (pow(b,8)*pow(dur,7)*(16632*R[0][0] + 49*(-990*R[1][0] + 1080*R[2][0] - 3*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]))))/4. -
      (7*pow(a,9)*pow(dur,6)*(5544*R[0][0] - 19404*R[1][0] + 7*(3780*R[2][0] - 6*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0]))))/9. +
      (7*pow(b,9)*pow(dur,6)*(5544*R[0][0] - 19404*R[1][0] + 7*(3780*R[2][0] - 6*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0]))))/9. +
      21*pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - 21*pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
      (7*pow(a,13)*pow(dur,2)*(396*R[0][0] - 2310*R[1][0] + 5670*R[2][0] - 7560*R[3][0] + 5880*R[4][0] - 2646*R[5][0] + 630*R[6][0] - 60*R[7][0]))/13. +
      (7*pow(b,13)*pow(dur,2)*(396*R[0][0] - 2310*R[1][0] + 5670*R[2][0] - 7560*R[3][0] + 5880*R[4][0] - 2646*R[5][0] + 630*R[6][0] - 60*R[7][0]))/13. +
      (7*pow(a,12)*pow(dur,3)*(660*R[0][0] - 3465*R[1][0] + 7560*R[2][0] - 8820*R[3][0] + 5880*R[4][0] - 2205*R[5][0] + 420*R[6][0] - 30*R[7][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(660*R[0][0] - 3465*R[1][0] + 7560*R[2][0] - 8820*R[3][0] + 5880*R[4][0] - 2205*R[5][0] + 420*R[6][0] - 30*R[7][0]))/6. -
      (7*pow(a,11)*pow(dur,4)*(2970*R[0][0] - 13860*R[1][0] + 26460*R[2][0] - 26460*R[3][0] + 14700*R[4][0] - 4410*R[5][0] + 630*R[6][0] - 30*R[7][0]))/11. +
      (7*pow(b,11)*pow(dur,4)*(2970*R[0][0] - 13860*R[1][0] + 26460*R[2][0] - 26460*R[3][0] + 14700*R[4][0] - 4410*R[5][0] + 630*R[6][0] - 30*R[7][0]))/11. +
      (7*pow(a,10)*pow(dur,5)*(2376*R[0][0] - 9702*R[1][0] + 15876*R[2][0] - 13230*R[3][0] + 5880*R[4][0] - 1323*R[5][0] + 126*R[6][0] - 3*R[7][0]))/5. -
      (7*pow(b,10)*pow(dur,5)*(2376*R[0][0] - 9702*R[1][0] + 15876*R[2][0] - 13230*R[3][0] + 5880*R[4][0] - 1323*R[5][0] + 126*R[6][0] - 3*R[7][0]))/5. -
      (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. +
      (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. +
      15*pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
      15*pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/pow(dur,14),
   (-14*pow(a,3)*pow(dur,12)*R[0][1] + 14*pow(b,3)*pow(dur,12)*R[0][1] + (7*pow(a,4)*pow(dur,11)*(36*R[0][1] - 21*R[1][1]))/2. - (7*pow(b,4)*pow(dur,11)*(36*R[0][1] - 21*R[1][1]))/2. -
      (7*pow(a,5)*pow(dur,10)*(396*R[0][1] + 7*(-66*R[1][1] + 18*R[2][1])))/5. + (7*pow(b,5)*pow(dur,10)*(396*R[0][1] + 7*(-66*R[1][1] + 18*R[2][1])))/5. +
      (7*pow(a,6)*pow(dur,9)*(660*R[0][1] + 35*(-33*R[1][1] + 9*R[2][1] + 3*(3*R[2][1] - R[3][1]))))/3. - (7*pow(b,6)*pow(dur,9)*(660*R[0][1] + 35*(-33*R[1][1] + 9*R[2][1] + 3*(3*R[2][1] - R[3][1]))))/3. -
      pow(a,7)*pow(dur,8)*(2970*R[0][1] + 7*(-990*R[1][1] + 5*(162*R[2][1] + 6*(-9*R[3][1] + R[4][1])))) + pow(b,7)*pow(dur,8)*(2970*R[0][1] + 7*(-990*R[1][1] + 5*(162*R[2][1] + 6*(-9*R[3][1] + R[4][1])))) +
      (pow(a,8)*pow(dur,7)*(16632*R[0][1] + 49*(-990*R[1][1] + 1080*R[2][1] - 3*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]))))/4. -
      (pow(b,8)*pow(dur,7)*(16632*R[0][1] + 49*(-990*R[1][1] + 1080*R[2][1] - 3*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]))))/4. -
      (7*pow(a,9)*pow(dur,6)*(5544*R[0][1] - 19404*R[1][1] + 7*(3780*R[2][1] - 6*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1]))))/9. +
      (7*pow(b,9)*pow(dur,6)*(5544*R[0][1] - 19404*R[1][1] + 7*(3780*R[2][1] - 6*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1]))))/9. +
      21*pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - 21*pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
      (7*pow(a,13)*pow(dur,2)*(396*R[0][1] - 2310*R[1][1] + 5670*R[2][1] - 7560*R[3][1] + 5880*R[4][1] - 2646*R[5][1] + 630*R[6][1] - 60*R[7][1]))/13. +
      (7*pow(b,13)*pow(dur,2)*(396*R[0][1] - 2310*R[1][1] + 5670*R[2][1] - 7560*R[3][1] + 5880*R[4][1] - 2646*R[5][1] + 630*R[6][1] - 60*R[7][1]))/13. +
      (7*pow(a,12)*pow(dur,3)*(660*R[0][1] - 3465*R[1][1] + 7560*R[2][1] - 8820*R[3][1] + 5880*R[4][1] - 2205*R[5][1] + 420*R[6][1] - 30*R[7][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(660*R[0][1] - 3465*R[1][1] + 7560*R[2][1] - 8820*R[3][1] + 5880*R[4][1] - 2205*R[5][1] + 420*R[6][1] - 30*R[7][1]))/6. -
      (7*pow(a,11)*pow(dur,4)*(2970*R[0][1] - 13860*R[1][1] + 26460*R[2][1] - 26460*R[3][1] + 14700*R[4][1] - 4410*R[5][1] + 630*R[6][1] - 30*R[7][1]))/11. +
      (7*pow(b,11)*pow(dur,4)*(2970*R[0][1] - 13860*R[1][1] + 26460*R[2][1] - 26460*R[3][1] + 14700*R[4][1] - 4410*R[5][1] + 630*R[6][1] - 30*R[7][1]))/11. +
      (7*pow(a,10)*pow(dur,5)*(2376*R[0][1] - 9702*R[1][1] + 15876*R[2][1] - 13230*R[3][1] + 5880*R[4][1] - 1323*R[5][1] + 126*R[6][1] - 3*R[7][1]))/5. -
      (7*pow(b,10)*pow(dur,5)*(2376*R[0][1] - 9702*R[1][1] + 15876*R[2][1] - 13230*R[3][1] + 5880*R[4][1] - 1323*R[5][1] + 126*R[6][1] - 3*R[7][1]))/5. -
      (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. +
      (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. +
      15*pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
      15*pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/pow(dur,14),
   ((-35*pow(a,4)*pow(dur,11)*R[0][0])/2. + (35*pow(b,4)*pow(dur,11)*R[0][0])/2. - (7*pow(a,5)*pow(dur,10)*(-110*R[0][0] + 70*R[1][0]))/5. +
      (7*pow(b,5)*pow(dur,10)*(-110*R[0][0] + 70*R[1][0]))/5. + (7*pow(a,6)*pow(dur,9)*(-275*R[0][0] + 35*(10*R[1][0] - 3*R[2][0])))/3. -
      (7*pow(b,6)*pow(dur,9)*(-275*R[0][0] + 35*(10*R[1][0] - 3*R[2][0])))/3. - pow(a,7)*pow(dur,8)*(-1650*R[0][0] + 7*(450*R[1][0] + 5*(-54*R[2][0] + 10*R[3][0]))) +
      pow(b,7)*pow(dur,8)*(-1650*R[0][0] + 7*(450*R[1][0] + 5*(-54*R[2][0] + 10*R[3][0]))) +
      (pow(a,8)*pow(dur,7)*(-11550*R[0][0] + 49*(600*R[1][0] - 540*R[2][0] + 100*R[3][0] + 25*(4*R[3][0] - R[4][0]))))/4. -
      (pow(b,8)*pow(dur,7)*(-11550*R[0][0] + 49*(600*R[1][0] - 540*R[2][0] + 100*R[3][0] + 25*(4*R[3][0] - R[4][0]))))/4. -
      (7*pow(a,9)*pow(dur,6)*(-4620*R[0][0] + 14700*R[1][0] + 7*(-2520*R[2][0] + 1400*R[3][0] + 5*(-70*R[4][0] + 6*R[5][0]))))/9. +
      (7*pow(b,9)*pow(dur,6)*(-4620*R[0][0] + 14700*R[1][0] + 7*(-2520*R[2][0] + 1400*R[3][0] + 5*(-70*R[4][0] + 6*R[5][0]))))/9. +
      (7*pow(a,10)*pow(dur,5)*(-2310*R[0][0] + 8820*R[1][0] - 13230*R[2][0] + 9800*R[3][0] - 3675*R[4][0] + 630*R[5][0] - 35*R[6][0]))/5. -
      (7*pow(b,10)*pow(dur,5)*(-2310*R[0][0] + 8820*R[1][0] - 13230*R[2][0] + 9800*R[3][0] - 3675*R[4][0] + 630*R[5][0] - 35*R[6][0]))/5. -
      35*pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + 35*pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) +
      (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. -
      (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. -
      20*pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
      20*pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
      (7*pow(a,11)*pow(dur,4)*(-3300*R[0][0] + 14700*R[1][0] - 26460*R[2][0] + 24500*R[3][0] - 12250*R[4][0] + 3150*R[5][0] - 350*R[6][0] + 10*R[7][0]))/11. +
      (7*pow(b,11)*pow(dur,4)*(-3300*R[0][0] + 14700*R[1][0] - 26460*R[2][0] + 24500*R[3][0] - 12250*R[4][0] + 3150*R[5][0] - 350*R[6][0] + 10*R[7][0]))/11. +
      (7*pow(a,12)*pow(dur,3)*(-825*R[0][0] + 4200*R[1][0] - 8820*R[2][0] + 9800*R[3][0] - 6125*R[4][0] + 2100*R[5][0] - 350*R[6][0] + 20*R[7][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(-825*R[0][0] + 4200*R[1][0] - 8820*R[2][0] + 9800*R[3][0] - 6125*R[4][0] + 2100*R[5][0] - 350*R[6][0] + 20*R[7][0]))/6. -
      (7*pow(a,13)*pow(dur,2)*(-550*R[0][0] + 3150*R[1][0] - 7560*R[2][0] + 9800*R[3][0] - 7350*R[4][0] + 3150*R[5][0] - 700*R[6][0] + 60*R[7][0]))/13. +
      (7*pow(b,13)*pow(dur,2)*(-550*R[0][0] + 3150*R[1][0] - 7560*R[2][0] + 9800*R[3][0] - 7350*R[4][0] + 3150*R[5][0] - 700*R[6][0] + 60*R[7][0]))/13.)/pow(dur,14),
   ((-35*pow(a,4)*pow(dur,11)*R[0][1])/2. + (35*pow(b,4)*pow(dur,11)*R[0][1])/2. - (7*pow(a,5)*pow(dur,10)*(-110*R[0][1] + 70*R[1][1]))/5. +
      (7*pow(b,5)*pow(dur,10)*(-110*R[0][1] + 70*R[1][1]))/5. + (7*pow(a,6)*pow(dur,9)*(-275*R[0][1] + 35*(10*R[1][1] - 3*R[2][1])))/3. -
      (7*pow(b,6)*pow(dur,9)*(-275*R[0][1] + 35*(10*R[1][1] - 3*R[2][1])))/3. - pow(a,7)*pow(dur,8)*(-1650*R[0][1] + 7*(450*R[1][1] + 5*(-54*R[2][1] + 10*R[3][1]))) +
      pow(b,7)*pow(dur,8)*(-1650*R[0][1] + 7*(450*R[1][1] + 5*(-54*R[2][1] + 10*R[3][1]))) +
      (pow(a,8)*pow(dur,7)*(-11550*R[0][1] + 49*(600*R[1][1] - 540*R[2][1] + 100*R[3][1] + 25*(4*R[3][1] - R[4][1]))))/4. -
      (pow(b,8)*pow(dur,7)*(-11550*R[0][1] + 49*(600*R[1][1] - 540*R[2][1] + 100*R[3][1] + 25*(4*R[3][1] - R[4][1]))))/4. -
      (7*pow(a,9)*pow(dur,6)*(-4620*R[0][1] + 14700*R[1][1] + 7*(-2520*R[2][1] + 1400*R[3][1] + 5*(-70*R[4][1] + 6*R[5][1]))))/9. +
      (7*pow(b,9)*pow(dur,6)*(-4620*R[0][1] + 14700*R[1][1] + 7*(-2520*R[2][1] + 1400*R[3][1] + 5*(-70*R[4][1] + 6*R[5][1]))))/9. +
      (7*pow(a,10)*pow(dur,5)*(-2310*R[0][1] + 8820*R[1][1] - 13230*R[2][1] + 9800*R[3][1] - 3675*R[4][1] + 630*R[5][1] - 35*R[6][1]))/5. -
      (7*pow(b,10)*pow(dur,5)*(-2310*R[0][1] + 8820*R[1][1] - 13230*R[2][1] + 9800*R[3][1] - 3675*R[4][1] + 630*R[5][1] - 35*R[6][1]))/5. -
      35*pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + 35*pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) +
      (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. -
      (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. -
      20*pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
      20*pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
      (7*pow(a,11)*pow(dur,4)*(-3300*R[0][1] + 14700*R[1][1] - 26460*R[2][1] + 24500*R[3][1] - 12250*R[4][1] + 3150*R[5][1] - 350*R[6][1] + 10*R[7][1]))/11. +
      (7*pow(b,11)*pow(dur,4)*(-3300*R[0][1] + 14700*R[1][1] - 26460*R[2][1] + 24500*R[3][1] - 12250*R[4][1] + 3150*R[5][1] - 350*R[6][1] + 10*R[7][1]))/11. +
      (7*pow(a,12)*pow(dur,3)*(-825*R[0][1] + 4200*R[1][1] - 8820*R[2][1] + 9800*R[3][1] - 6125*R[4][1] + 2100*R[5][1] - 350*R[6][1] + 20*R[7][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(-825*R[0][1] + 4200*R[1][1] - 8820*R[2][1] + 9800*R[3][1] - 6125*R[4][1] + 2100*R[5][1] - 350*R[6][1] + 20*R[7][1]))/6. -
      (7*pow(a,13)*pow(dur,2)*(-550*R[0][1] + 3150*R[1][1] - 7560*R[2][1] + 9800*R[3][1] - 7350*R[4][1] + 3150*R[5][1] - 700*R[6][1] + 60*R[7][1]))/13. +
      (7*pow(b,13)*pow(dur,2)*(-550*R[0][1] + 3150*R[1][1] - 7560*R[2][1] + 9800*R[3][1] - 7350*R[4][1] + 3150*R[5][1] - 700*R[6][1] + 60*R[7][1]))/13.)/pow(dur,14),
   (-14*pow(a,5)*pow(dur,10)*R[0][0] + 14*pow(b,5)*pow(dur,10)*R[0][0] + (7*pow(a,6)*pow(dur,9)*(50*R[0][0] - 35*R[1][0]))/3. - (7*pow(b,6)*pow(dur,9)*(50*R[0][0] - 35*R[1][0]))/3. -
      pow(a,7)*pow(dur,8)*(450*R[0][0] + 7*(-90*R[1][0] + 30*R[2][0])) + pow(b,7)*pow(dur,8)*(450*R[0][0] + 7*(-90*R[1][0] + 30*R[2][0])) +
      (pow(a,8)*pow(dur,7)*(4200*R[0][0] + 49*(-180*R[1][0] + 120*R[2][0] - 25*R[3][0])))/4. - (pow(b,8)*pow(dur,7)*(4200*R[0][0] + 49*(-180*R[1][0] + 120*R[2][0] - 25*R[3][0])))/4. -
      (7*pow(a,9)*pow(dur,6)*(2100*R[0][0] - 5880*R[1][0] + 7*(840*R[2][0] - 350*R[3][0] + 50*R[4][0])))/9. +
      (7*pow(b,9)*pow(dur,6)*(2100*R[0][0] - 5880*R[1][0] + 7*(840*R[2][0] - 350*R[3][0] + 50*R[4][0])))/9. +
      (7*pow(a,10)*pow(dur,5)*(1260*R[0][0] - 4410*R[1][0] + 5880*R[2][0] - 3675*R[3][0] + 1050*R[4][0] - 105*R[5][0]))/5. -
      (7*pow(b,10)*pow(dur,5)*(1260*R[0][0] - 4410*R[1][0] + 5880*R[2][0] - 3675*R[3][0] + 1050*R[4][0] - 105*R[5][0]))/5. +
      35*pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - 35*pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
      (7*pow(a,11)*pow(dur,4)*(2100*R[0][0] - 8820*R[1][0] + 14700*R[2][0] - 12250*R[3][0] + 5250*R[4][0] - 1050*R[5][0] + 70*R[6][0]))/11. +
      (7*pow(b,11)*pow(dur,4)*(2100*R[0][0] - 8820*R[1][0] + 14700*R[2][0] - 12250*R[3][0] + 5250*R[4][0] - 1050*R[5][0] + 70*R[6][0]))/11. -
      (7*pow(a,13)*pow(dur,2)*(450*R[0][0] - 2520*R[1][0] + 5880*R[2][0] - 7350*R[3][0] + 5250*R[4][0] - 2100*R[5][0] + 420*R[6][0] - 30*R[7][0]))/13. +
      (7*pow(b,13)*pow(dur,2)*(450*R[0][0] - 2520*R[1][0] + 5880*R[2][0] - 7350*R[3][0] + 5250*R[4][0] - 2100*R[5][0] + 420*R[6][0] - 30*R[7][0]))/13. +
      (7*pow(a,12)*pow(dur,3)*(600*R[0][0] - 2940*R[1][0] + 5880*R[2][0] - 6125*R[3][0] + 3500*R[4][0] - 1050*R[5][0] + 140*R[6][0] - 5*R[7][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(600*R[0][0] - 2940*R[1][0] + 5880*R[2][0] - 6125*R[3][0] + 3500*R[4][0] - 1050*R[5][0] + 140*R[6][0] - 5*R[7][0]))/6. -
      (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. +
      (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. +
      15*pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
      15*pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/pow(dur,14),
   (-14*pow(a,5)*pow(dur,10)*R[0][1] + 14*pow(b,5)*pow(dur,10)*R[0][1] + (7*pow(a,6)*pow(dur,9)*(50*R[0][1] - 35*R[1][1]))/3. - (7*pow(b,6)*pow(dur,9)*(50*R[0][1] - 35*R[1][1]))/3. -
      pow(a,7)*pow(dur,8)*(450*R[0][1] + 7*(-90*R[1][1] + 30*R[2][1])) + pow(b,7)*pow(dur,8)*(450*R[0][1] + 7*(-90*R[1][1] + 30*R[2][1])) +
      (pow(a,8)*pow(dur,7)*(4200*R[0][1] + 49*(-180*R[1][1] + 120*R[2][1] - 25*R[3][1])))/4. - (pow(b,8)*pow(dur,7)*(4200*R[0][1] + 49*(-180*R[1][1] + 120*R[2][1] - 25*R[3][1])))/4. -
      (7*pow(a,9)*pow(dur,6)*(2100*R[0][1] - 5880*R[1][1] + 7*(840*R[2][1] - 350*R[3][1] + 50*R[4][1])))/9. +
      (7*pow(b,9)*pow(dur,6)*(2100*R[0][1] - 5880*R[1][1] + 7*(840*R[2][1] - 350*R[3][1] + 50*R[4][1])))/9. +
      (7*pow(a,10)*pow(dur,5)*(1260*R[0][1] - 4410*R[1][1] + 5880*R[2][1] - 3675*R[3][1] + 1050*R[4][1] - 105*R[5][1]))/5. -
      (7*pow(b,10)*pow(dur,5)*(1260*R[0][1] - 4410*R[1][1] + 5880*R[2][1] - 3675*R[3][1] + 1050*R[4][1] - 105*R[5][1]))/5. +
      35*pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - 35*pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
      (7*pow(a,11)*pow(dur,4)*(2100*R[0][1] - 8820*R[1][1] + 14700*R[2][1] - 12250*R[3][1] + 5250*R[4][1] - 1050*R[5][1] + 70*R[6][1]))/11. +
      (7*pow(b,11)*pow(dur,4)*(2100*R[0][1] - 8820*R[1][1] + 14700*R[2][1] - 12250*R[3][1] + 5250*R[4][1] - 1050*R[5][1] + 70*R[6][1]))/11. -
      (7*pow(a,13)*pow(dur,2)*(450*R[0][1] - 2520*R[1][1] + 5880*R[2][1] - 7350*R[3][1] + 5250*R[4][1] - 2100*R[5][1] + 420*R[6][1] - 30*R[7][1]))/13. +
      (7*pow(b,13)*pow(dur,2)*(450*R[0][1] - 2520*R[1][1] + 5880*R[2][1] - 7350*R[3][1] + 5250*R[4][1] - 2100*R[5][1] + 420*R[6][1] - 30*R[7][1]))/13. +
      (7*pow(a,12)*pow(dur,3)*(600*R[0][1] - 2940*R[1][1] + 5880*R[2][1] - 6125*R[3][1] + 3500*R[4][1] - 1050*R[5][1] + 140*R[6][1] - 5*R[7][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(600*R[0][1] - 2940*R[1][1] + 5880*R[2][1] - 6125*R[3][1] + 3500*R[4][1] - 1050*R[5][1] + 140*R[6][1] - 5*R[7][1]))/6. -
      (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. +
      (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. +
      15*pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
      15*pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/pow(dur,14),
   (-7*pow(a,6)*pow(dur,9)*R[0][0] + 7*pow(b,6)*pow(dur,9)*R[0][0] - pow(a,7)*pow(dur,8)*(-54*R[0][0] + 42*R[1][0]) + pow(b,7)*pow(dur,8)*(-54*R[0][0] + 42*R[1][0]) +
      (pow(a,8)*pow(dur,7)*(-756*R[0][0] + 49*(24*R[1][0] - 9*R[2][0])))/4. - (pow(b,8)*pow(dur,7)*(-756*R[0][0] + 49*(24*R[1][0] - 9*R[2][0])))/4. -
      (7*pow(a,9)*pow(dur,6)*(-504*R[0][0] + 1176*R[1][0] + 7*(-126*R[2][0] + 30*R[3][0])))/9. + (7*pow(b,9)*pow(dur,6)*(-504*R[0][0] + 1176*R[1][0] + 7*(-126*R[2][0] + 30*R[3][0])))/9. +
      (7*pow(a,10)*pow(dur,5)*(-378*R[0][0] + 1176*R[1][0] - 1323*R[2][0] + 630*R[3][0] - 105*R[4][0]))/5. -
      (7*pow(b,10)*pow(dur,5)*(-378*R[0][0] + 1176*R[1][0] - 1323*R[2][0] + 630*R[3][0] - 105*R[4][0]))/5. -
      (7*pow(a,11)*pow(dur,4)*(-756*R[0][0] + 2940*R[1][0] - 4410*R[2][0] + 3150*R[3][0] - 1050*R[4][0] + 126*R[5][0]))/11. +
      (7*pow(b,11)*pow(dur,4)*(-756*R[0][0] + 2940*R[1][0] - 4410*R[2][0] + 3150*R[3][0] - 1050*R[4][0] + 126*R[5][0]))/11. +
      (7*pow(a,12)*pow(dur,3)*(-252*R[0][0] + 1176*R[1][0] - 2205*R[2][0] + 2100*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 21*R[6][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(-252*R[0][0] + 1176*R[1][0] - 2205*R[2][0] + 2100*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 21*R[6][0]))/6. -
      21*pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + 21*pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) +
      (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. -
      (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. -
      6*pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
      6*pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
      (7*pow(a,13)*pow(dur,2)*(-216*R[0][0] + 1176*R[1][0] - 2646*R[2][0] + 3150*R[3][0] - 2100*R[4][0] + 756*R[5][0] - 126*R[6][0] + 6*R[7][0]))/13. +
      (7*pow(b,13)*pow(dur,2)*(-216*R[0][0] + 1176*R[1][0] - 2646*R[2][0] + 3150*R[3][0] - 2100*R[4][0] + 756*R[5][0] - 126*R[6][0] + 6*R[7][0]))/13.)/pow(dur,14),
   (-7*pow(a,6)*pow(dur,9)*R[0][1] + 7*pow(b,6)*pow(dur,9)*R[0][1] - pow(a,7)*pow(dur,8)*(-54*R[0][1] + 42*R[1][1]) + pow(b,7)*pow(dur,8)*(-54*R[0][1] + 42*R[1][1]) +
      (pow(a,8)*pow(dur,7)*(-756*R[0][1] + 49*(24*R[1][1] - 9*R[2][1])))/4. - (pow(b,8)*pow(dur,7)*(-756*R[0][1] + 49*(24*R[1][1] - 9*R[2][1])))/4. -
      (7*pow(a,9)*pow(dur,6)*(-504*R[0][1] + 1176*R[1][1] + 7*(-126*R[2][1] + 30*R[3][1])))/9. + (7*pow(b,9)*pow(dur,6)*(-504*R[0][1] + 1176*R[1][1] + 7*(-126*R[2][1] + 30*R[3][1])))/9. +
      (7*pow(a,10)*pow(dur,5)*(-378*R[0][1] + 1176*R[1][1] - 1323*R[2][1] + 630*R[3][1] - 105*R[4][1]))/5. -
      (7*pow(b,10)*pow(dur,5)*(-378*R[0][1] + 1176*R[1][1] - 1323*R[2][1] + 630*R[3][1] - 105*R[4][1]))/5. -
      (7*pow(a,11)*pow(dur,4)*(-756*R[0][1] + 2940*R[1][1] - 4410*R[2][1] + 3150*R[3][1] - 1050*R[4][1] + 126*R[5][1]))/11. +
      (7*pow(b,11)*pow(dur,4)*(-756*R[0][1] + 2940*R[1][1] - 4410*R[2][1] + 3150*R[3][1] - 1050*R[4][1] + 126*R[5][1]))/11. +
      (7*pow(a,12)*pow(dur,3)*(-252*R[0][1] + 1176*R[1][1] - 2205*R[2][1] + 2100*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 21*R[6][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(-252*R[0][1] + 1176*R[1][1] - 2205*R[2][1] + 2100*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 21*R[6][1]))/6. -
      21*pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + 21*pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) +
      (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. -
      (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. -
      6*pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
      6*pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
      (7*pow(a,13)*pow(dur,2)*(-216*R[0][1] + 1176*R[1][1] - 2646*R[2][1] + 3150*R[3][1] - 2100*R[4][1] + 756*R[5][1] - 126*R[6][1] + 6*R[7][1]))/13. +
      (7*pow(b,13)*pow(dur,2)*(-216*R[0][1] + 1176*R[1][1] - 2646*R[2][1] + 3150*R[3][1] - 2100*R[4][1] + 756*R[5][1] - 126*R[6][1] + 6*R[7][1]))/13.)/pow(dur,14),
   (-2*pow(a,7)*pow(dur,8)*R[0][0] + 2*pow(b,7)*pow(dur,8)*R[0][0] + (pow(a,8)*pow(dur,7)*(56*R[0][0] - 49*R[1][0]))/4. - (pow(b,8)*pow(dur,7)*(56*R[0][0] - 49*R[1][0]))/4. -
      (7*pow(a,9)*pow(dur,6)*(56*R[0][0] - 98*R[1][0] + 42*R[2][0]))/9. + (7*pow(b,9)*pow(dur,6)*(56*R[0][0] - 98*R[1][0] + 42*R[2][0]))/9. +
      (7*pow(a,10)*pow(dur,5)*(56*R[0][0] - 147*R[1][0] + 126*R[2][0] - 35*R[3][0]))/5. - (7*pow(b,10)*pow(dur,5)*(56*R[0][0] - 147*R[1][0] + 126*R[2][0] - 35*R[3][0]))/5. -
      (7*pow(a,11)*pow(dur,4)*(140*R[0][0] - 490*R[1][0] + 630*R[2][0] - 350*R[3][0] + 70*R[4][0]))/11. + (7*pow(b,11)*pow(dur,4)*(140*R[0][0] - 490*R[1][0] + 630*R[2][0] - 350*R[3][0] + 70*R[4][0]))/11. +
      (7*pow(a,12)*pow(dur,3)*(56*R[0][0] - 245*R[1][0] + 420*R[2][0] - 350*R[3][0] + 140*R[4][0] - 21*R[5][0]))/6. -
      (7*pow(b,12)*pow(dur,3)*(56*R[0][0] - 245*R[1][0] + 420*R[2][0] - 350*R[3][0] + 140*R[4][0] - 21*R[5][0]))/6. +
      7*pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - 7*pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
      (7*pow(a,13)*pow(dur,2)*(56*R[0][0] - 294*R[1][0] + 630*R[2][0] - 700*R[3][0] + 420*R[4][0] - 126*R[5][0] + 14*R[6][0]))/13. +
      (7*pow(b,13)*pow(dur,2)*(56*R[0][0] - 294*R[1][0] + 630*R[2][0] - 700*R[3][0] + 420*R[4][0] - 126*R[5][0] + 14*R[6][0]))/13. -
      (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
      (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
      pow(a,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
      pow(b,14)*dur*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/pow(dur,14),
   (-2*pow(a,7)*pow(dur,8)*R[0][1] + 2*pow(b,7)*pow(dur,8)*R[0][1] + (pow(a,8)*pow(dur,7)*(56*R[0][1] - 49*R[1][1]))/4. - (pow(b,8)*pow(dur,7)*(56*R[0][1] - 49*R[1][1]))/4. -
      (7*pow(a,9)*pow(dur,6)*(56*R[0][1] - 98*R[1][1] + 42*R[2][1]))/9. + (7*pow(b,9)*pow(dur,6)*(56*R[0][1] - 98*R[1][1] + 42*R[2][1]))/9. +
      (7*pow(a,10)*pow(dur,5)*(56*R[0][1] - 147*R[1][1] + 126*R[2][1] - 35*R[3][1]))/5. - (7*pow(b,10)*pow(dur,5)*(56*R[0][1] - 147*R[1][1] + 126*R[2][1] - 35*R[3][1]))/5. -
      (7*pow(a,11)*pow(dur,4)*(140*R[0][1] - 490*R[1][1] + 630*R[2][1] - 350*R[3][1] + 70*R[4][1]))/11. + (7*pow(b,11)*pow(dur,4)*(140*R[0][1] - 490*R[1][1] + 630*R[2][1] - 350*R[3][1] + 70*R[4][1]))/11. +
      (7*pow(a,12)*pow(dur,3)*(56*R[0][1] - 245*R[1][1] + 420*R[2][1] - 350*R[3][1] + 140*R[4][1] - 21*R[5][1]))/6. -
      (7*pow(b,12)*pow(dur,3)*(56*R[0][1] - 245*R[1][1] + 420*R[2][1] - 350*R[3][1] + 140*R[4][1] - 21*R[5][1]))/6. +
      7*pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - 7*pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
      (7*pow(a,13)*pow(dur,2)*(56*R[0][1] - 294*R[1][1] + 630*R[2][1] - 700*R[3][1] + 420*R[4][1] - 126*R[5][1] + 14*R[6][1]))/13. +
      (7*pow(b,13)*pow(dur,2)*(56*R[0][1] - 294*R[1][1] + 630*R[2][1] - 700*R[3][1] + 420*R[4][1] - 126*R[5][1] + 14*R[6][1]))/13. -
      (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
      (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
      pow(a,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
      pow(b,14)*dur*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/pow(dur,14),
   (-(pow(a,8)*pow(dur,7)*R[0][0])/4. + (pow(b,8)*pow(dur,7)*R[0][0])/4. - (7*pow(a,9)*pow(dur,6)*(-2*R[0][0] + 2*R[1][0]))/9. + (7*pow(b,9)*pow(dur,6)*(-2*R[0][0] + 2*R[1][0]))/9. +
      (7*pow(a,10)*pow(dur,5)*(-3*R[0][0] + 6*R[1][0] - 3*R[2][0]))/5. - (7*pow(b,10)*pow(dur,5)*(-3*R[0][0] + 6*R[1][0] - 3*R[2][0]))/5. -
      (7*pow(a,11)*pow(dur,4)*(-10*R[0][0] + 30*R[1][0] - 30*R[2][0] + 10*R[3][0]))/11. + (7*pow(b,11)*pow(dur,4)*(-10*R[0][0] + 30*R[1][0] - 30*R[2][0] + 10*R[3][0]))/11. +
      (7*pow(a,12)*pow(dur,3)*(-5*R[0][0] + 20*R[1][0] - 30*R[2][0] + 20*R[3][0] - 5*R[4][0]))/6. - (7*pow(b,12)*pow(dur,3)*(-5*R[0][0] + 20*R[1][0] - 30*R[2][0] + 20*R[3][0] - 5*R[4][0]))/6. -
      (7*pow(a,13)*pow(dur,2)*(-6*R[0][0] + 30*R[1][0] - 60*R[2][0] + 60*R[3][0] - 30*R[4][0] + 6*R[5][0]))/13. +
      (7*pow(b,13)*pow(dur,2)*(-6*R[0][0] + 30*R[1][0] - 60*R[2][0] + 60*R[3][0] - 30*R[4][0] + 6*R[5][0]))/13. - pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) +
      pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) +
      (2*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. -
      (2*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15.)/pow(dur,14),
   (-(pow(a,8)*pow(dur,7)*R[0][1])/4. + (pow(b,8)*pow(dur,7)*R[0][1])/4. - (7*pow(a,9)*pow(dur,6)*(-2*R[0][1] + 2*R[1][1]))/9. + (7*pow(b,9)*pow(dur,6)*(-2*R[0][1] + 2*R[1][1]))/9. +
      (7*pow(a,10)*pow(dur,5)*(-3*R[0][1] + 6*R[1][1] - 3*R[2][1]))/5. - (7*pow(b,10)*pow(dur,5)*(-3*R[0][1] + 6*R[1][1] - 3*R[2][1]))/5. -
      (7*pow(a,11)*pow(dur,4)*(-10*R[0][1] + 30*R[1][1] - 30*R[2][1] + 10*R[3][1]))/11. + (7*pow(b,11)*pow(dur,4)*(-10*R[0][1] + 30*R[1][1] - 30*R[2][1] + 10*R[3][1]))/11. +
      (7*pow(a,12)*pow(dur,3)*(-5*R[0][1] + 20*R[1][1] - 30*R[2][1] + 20*R[3][1] - 5*R[4][1]))/6. - (7*pow(b,12)*pow(dur,3)*(-5*R[0][1] + 20*R[1][1] - 30*R[2][1] + 20*R[3][1] - 5*R[4][1]))/6. -
      (7*pow(a,13)*pow(dur,2)*(-6*R[0][1] + 30*R[1][1] - 60*R[2][1] + 60*R[3][1] - 30*R[4][1] + 6*R[5][1]))/13. +
      (7*pow(b,13)*pow(dur,2)*(-6*R[0][1] + 30*R[1][1] - 60*R[2][1] + 60*R[3][1] - 30*R[4][1] + 6*R[5][1]))/13. - pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) +
      pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) +
      (2*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. -
      (2*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15.)/pow(dur,14)};
}

/*
integrate from a to b
*/
double bezier_integrate_2d_8pts(double a, double b, vector<vectoreuc>& R, double dur) {
  return (-(a*pow(dur,14)*pow(R[0][0],2)) + b*pow(dur,14)*pow(R[0][0],2) - a*pow(dur,14)*pow(R[0][1],2) + b*pow(dur,14)*pow(R[0][1],2) + 7*pow(a,2)*pow(dur,13)*R[0][0]*(R[0][0] - R[1][0]) -
     7*pow(b,2)*pow(dur,13)*R[0][0]*(R[0][0] - R[1][0]) + 7*pow(a,2)*pow(dur,13)*R[0][1]*(R[0][1] - R[1][1]) - 7*pow(b,2)*pow(dur,13)*R[0][1]*(R[0][1] - R[1][1]) -
     (7*pow(a,3)*pow(dur,12)*(13*pow(R[0][0],2) + 7*pow(R[1][0],2) + R[0][0]*(-26*R[1][0] + 6*R[2][0])))/3. +
     (7*pow(b,3)*pow(dur,12)*(13*pow(R[0][0],2) + 7*pow(R[1][0],2) + R[0][0]*(-26*R[1][0] + 6*R[2][0])))/3. -
     (7*pow(a,3)*pow(dur,12)*(13*pow(R[0][1],2) + 7*pow(R[1][1],2) + R[0][1]*(-26*R[1][1] + 6*R[2][1])))/3. +
     (7*pow(b,3)*pow(dur,12)*(13*pow(R[0][1],2) + 7*pow(R[1][1],2) + R[0][1]*(-26*R[1][1] + 6*R[2][1])))/3. +
     (7*pow(a,4)*pow(dur,11)*(26*pow(R[0][0],2) + 21*R[1][0]*(2*R[1][0] - R[2][0]) + R[0][0]*(-78*R[1][0] + 36*R[2][0] - 5*R[3][0])))/2. -
     (7*pow(b,4)*pow(dur,11)*(26*pow(R[0][0],2) + 21*R[1][0]*(2*R[1][0] - R[2][0]) + R[0][0]*(-78*R[1][0] + 36*R[2][0] - 5*R[3][0])))/2. +
     (7*pow(a,4)*pow(dur,11)*(26*pow(R[0][1],2) + 21*R[1][1]*(2*R[1][1] - R[2][1]) + R[0][1]*(-78*R[1][1] + 36*R[2][1] - 5*R[3][1])))/2. -
     (7*pow(b,4)*pow(dur,11)*(26*pow(R[0][1],2) + 21*R[1][1]*(2*R[1][1] - R[2][1]) + R[0][1]*(-78*R[1][1] + 36*R[2][1] - 5*R[3][1])))/2. -
     (7*pow(a,5)*pow(dur,10)*(143*pow(R[0][0],2) + 7*(66*pow(R[1][0],2) + 9*pow(R[2][0],2) + R[1][0]*(-66*R[2][0] + 10*R[3][0])) - 2*R[0][0]*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. +
     (7*pow(b,5)*pow(dur,10)*(143*pow(R[0][0],2) + 7*(66*pow(R[1][0],2) + 9*pow(R[2][0],2) + R[1][0]*(-66*R[2][0] + 10*R[3][0])) - 2*R[0][0]*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. -
     (7*pow(a,5)*pow(dur,10)*(143*pow(R[0][1],2) + 7*(66*pow(R[1][1],2) + 9*pow(R[2][1],2) + R[1][1]*(-66*R[2][1] + 10*R[3][1])) - 2*R[0][1]*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. +
     (7*pow(b,5)*pow(dur,10)*(143*pow(R[0][1],2) + 7*(66*pow(R[1][1],2) + 9*pow(R[2][1],2) + R[1][1]*(-66*R[2][1] + 10*R[3][1])) - 2*R[0][1]*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. +
     (7*pow(a,6)*pow(dur,9)*(143*pow(R[0][0],2) + 35*(22*pow(R[1][0],2) + 3*R[2][0]*(3*R[2][0] - R[3][0]) - R[1][0]*(33*R[2][0] - 10*R[3][0] + R[4][0])) +
          R[0][0]*(-715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0])))/3. -
     (7*pow(b,6)*pow(dur,9)*(143*pow(R[0][0],2) + 35*(22*pow(R[1][0],2) + 3*R[2][0]*(3*R[2][0] - R[3][0]) - R[1][0]*(33*R[2][0] - 10*R[3][0] + R[4][0])) +
          R[0][0]*(-715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0])))/3. +
     (7*pow(a,6)*pow(dur,9)*(143*pow(R[0][1],2) + 35*(22*pow(R[1][1],2) + 3*R[2][1]*(3*R[2][1] - R[3][1]) - R[1][1]*(33*R[2][1] - 10*R[3][1] + R[4][1])) +
          R[0][1]*(-715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1])))/3. -
     (7*pow(b,6)*pow(dur,9)*(143*pow(R[0][1],2) + 35*(22*pow(R[1][1],2) + 3*R[2][1]*(3*R[2][1] - R[3][1]) - R[1][1]*(33*R[2][1] - 10*R[3][1] + R[4][1])) +
          R[0][1]*(-715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1])))/3. -
     pow(a,7)*pow(dur,8)*(429*pow(R[0][0],2) + 7*(495*pow(R[1][0],2) + 5*(81*pow(R[2][0],2) + 5*pow(R[3][0],2) + 6*R[2][0]*(-9*R[3][0] + R[4][0])) +
           6*R[1][0]*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0])) + 2*R[0][0]*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) +
     pow(b,7)*pow(dur,8)*(429*pow(R[0][0],2) + 7*(495*pow(R[1][0],2) + 5*(81*pow(R[2][0],2) + 5*pow(R[3][0],2) + 6*R[2][0]*(-9*R[3][0] + R[4][0])) +
           6*R[1][0]*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0])) + 2*R[0][0]*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) -
     pow(a,7)*pow(dur,8)*(429*pow(R[0][1],2) + 7*(495*pow(R[1][1],2) + 5*(81*pow(R[2][1],2) + 5*pow(R[3][1],2) + 6*R[2][1]*(-9*R[3][1] + R[4][1])) +
           6*R[1][1]*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1])) + 2*R[0][1]*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
     pow(b,7)*pow(dur,8)*(429*pow(R[0][1],2) + 7*(495*pow(R[1][1],2) + 5*(81*pow(R[2][1],2) + 5*pow(R[3][1],2) + 6*R[2][1]*(-9*R[3][1] + R[4][1])) +
           6*R[1][1]*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1])) + 2*R[0][1]*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
     pow(a,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0])*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
     pow(b,14)*dur*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0])*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
     (pow(a,15)*pow(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0],2))/15. +
     (pow(b,15)*pow(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0],2))/15. +
     (7*pow(a,10)*pow(dur,5)*(143*pow(R[0][0],2) + 2772*pow(R[1][0],2) + 7938*pow(R[2][0],2) - 13230*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 3675*R[3][0]*R[4][0] +
          525*pow(R[4][0],2) - 1323*R[2][0]*R[5][0] + 630*R[3][0]*R[5][0] - 105*R[4][0]*R[5][0] + 126*R[2][0]*R[6][0] - 35*R[3][0]*R[6][0] +
          R[0][0]*(-1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]) - 3*R[1][0]*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0]) -
          3*R[2][0]*R[7][0]))/5. - (7*pow(b,10)*pow(dur,5)*(143*pow(R[0][0],2) + 2772*pow(R[1][0],2) + 7938*pow(R[2][0],2) - 13230*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] -
          3675*R[3][0]*R[4][0] + 525*pow(R[4][0],2) - 1323*R[2][0]*R[5][0] + 630*R[3][0]*R[5][0] - 105*R[4][0]*R[5][0] + 126*R[2][0]*R[6][0] - 35*R[3][0]*R[6][0] +
          R[0][0]*(-1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]) - 3*R[1][0]*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0]) -
          3*R[2][0]*R[7][0]))/5. + (pow(a,8)*pow(dur,7)*(1716*pow(R[0][0],2) + 49*
           (396*pow(R[1][0],2) + 540*pow(R[2][0],2) + 25*R[3][0]*(4*R[3][0] - R[4][0]) - 3*R[2][0]*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]) - R[1][0]*(990*R[2][0] - 600*R[3][0] + 180*R[4][0] - 24*R[5][0] + R[6][0])) -
          R[0][0]*(12012*R[1][0] - 16632*R[2][0] + 11550*R[3][0] - 4200*R[4][0] + 756*R[5][0] - 56*R[6][0] + R[7][0])))/4. -
     (pow(b,8)*pow(dur,7)*(1716*pow(R[0][0],2) + 49*(396*pow(R[1][0],2) + 540*pow(R[2][0],2) + 25*R[3][0]*(4*R[3][0] - R[4][0]) - 3*R[2][0]*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]) -
             R[1][0]*(990*R[2][0] - 600*R[3][0] + 180*R[4][0] - 24*R[5][0] + R[6][0])) - R[0][0]*(12012*R[1][0] - 16632*R[2][0] + 11550*R[3][0] - 4200*R[4][0] + 756*R[5][0] - 56*R[6][0] + R[7][0])))/4. -
     (7*pow(a,9)*pow(dur,6)*(429*pow(R[0][0],2) + 6468*pow(R[1][0],2) + 7*(1890*pow(R[2][0],2) + 700*pow(R[3][0],2) + 25*pow(R[4][0],2) + 5*R[3][0]*(-70*R[4][0] + 6*R[5][0]) -
             6*R[2][0]*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0])) - 2*R[1][0]*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0]) -
          2*R[0][0]*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. +
     (7*pow(b,9)*pow(dur,6)*(429*pow(R[0][0],2) + 6468*pow(R[1][0],2) + 7*(1890*pow(R[2][0],2) + 700*pow(R[3][0],2) + 25*pow(R[4][0],2) + 5*R[3][0]*(-70*R[4][0] + 6*R[5][0]) -
             6*R[2][0]*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0])) - 2*R[1][0]*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0]) -
          2*R[0][0]*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. -
     (7*pow(a,13)*pow(dur,2)*(13*pow(R[0][0],2) + 462*pow(R[1][0],2) + 2835*pow(R[2][0],2) - 7560*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 7350*R[3][0]*R[4][0] +
          2625*pow(R[4][0],2) - 2646*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 2100*R[4][0]*R[5][0] + 378*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 700*R[3][0]*R[6][0] + 420*R[4][0]*R[6][0] - 126*R[5][0]*R[6][0] +
          7*pow(R[6][0],2) - 6*R[1][0]*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0]) - 60*R[2][0]*R[7][0] + 60*R[3][0]*R[7][0] - 30*R[4][0]*R[7][0] + 6*R[5][0]*R[7][0] -
          2*R[0][0]*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. +
     (7*pow(b,13)*pow(dur,2)*(13*pow(R[0][0],2) + 462*pow(R[1][0],2) + 2835*pow(R[2][0],2) - 7560*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 7350*R[3][0]*R[4][0] +
          2625*pow(R[4][0],2) - 2646*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 2100*R[4][0]*R[5][0] + 378*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 700*R[3][0]*R[6][0] + 420*R[4][0]*R[6][0] - 126*R[5][0]*R[6][0] +
          7*pow(R[6][0],2) - 6*R[1][0]*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0]) - 60*R[2][0]*R[7][0] + 60*R[3][0]*R[7][0] - 30*R[4][0]*R[7][0] + 6*R[5][0]*R[7][0] -
          2*R[0][0]*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. -
     (7*pow(a,11)*pow(dur,4)*(143*pow(R[0][0],2) + 3465*pow(R[1][0],2) + 13230*pow(R[2][0],2) - 26460*R[2][0]*R[3][0] + 12250*pow(R[3][0],2) + 14700*R[2][0]*R[4][0] - 12250*R[3][0]*R[4][0] +
          2625*pow(R[4][0],2) - 4410*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 63*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 70*R[4][0]*R[6][0] -
          10*R[1][0]*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0]) - 30*R[2][0]*R[7][0] + 10*R[3][0]*R[7][0] -
          2*R[0][0]*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11. +
     (7*pow(b,11)*pow(dur,4)*(143*pow(R[0][0],2) + 3465*pow(R[1][0],2) + 13230*pow(R[2][0],2) - 26460*R[2][0]*R[3][0] + 12250*pow(R[3][0],2) + 14700*R[2][0]*R[4][0] - 12250*R[3][0]*R[4][0] +
          2625*pow(R[4][0],2) - 4410*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 63*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 70*R[4][0]*R[6][0] -
          10*R[1][0]*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0]) - 30*R[2][0]*R[7][0] + 10*R[3][0]*R[7][0] -
          2*R[0][0]*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11. +
     (7*pow(a,12)*pow(dur,3)*(26*pow(R[0][0],2) + 770*pow(R[1][0],2) + 3780*pow(R[2][0],2) - 8820*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 6125*R[3][0]*R[4][0] +
          1750*pow(R[4][0],2) - 2205*R[2][0]*R[5][0] + 2100*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 126*pow(R[5][0],2) + 420*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 140*R[4][0]*R[6][0] - 21*R[5][0]*R[6][0] +
          R[0][0]*(-286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]) - 30*R[2][0]*R[7][0] + 20*R[3][0]*R[7][0] - 5*R[4][0]*R[7][0] +
          R[1][0]*(-3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0])))/6. -
     (7*pow(b,12)*pow(dur,3)*(26*pow(R[0][0],2) + 770*pow(R[1][0],2) + 3780*pow(R[2][0],2) - 8820*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 6125*R[3][0]*R[4][0] +
          1750*pow(R[4][0],2) - 2205*R[2][0]*R[5][0] + 2100*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 126*pow(R[5][0],2) + 420*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 140*R[4][0]*R[6][0] - 21*R[5][0]*R[6][0] +
          R[0][0]*(-286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]) - 30*R[2][0]*R[7][0] + 20*R[3][0]*R[7][0] - 5*R[4][0]*R[7][0] +
          R[1][0]*(-3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0])))/6. +
     pow(a,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1])*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
     pow(b,14)*dur*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1])*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
     (pow(a,15)*pow(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1],2))/15. +
     (pow(b,15)*pow(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1],2))/15. +
     (7*pow(a,10)*pow(dur,5)*(143*pow(R[0][1],2) + 2772*pow(R[1][1],2) + 7938*pow(R[2][1],2) - 13230*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 3675*R[3][1]*R[4][1] +
          525*pow(R[4][1],2) - 1323*R[2][1]*R[5][1] + 630*R[3][1]*R[5][1] - 105*R[4][1]*R[5][1] + 126*R[2][1]*R[6][1] - 35*R[3][1]*R[6][1] +
          R[0][1]*(-1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]) - 3*R[1][1]*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1]) -
          3*R[2][1]*R[7][1]))/5. - (7*pow(b,10)*pow(dur,5)*(143*pow(R[0][1],2) + 2772*pow(R[1][1],2) + 7938*pow(R[2][1],2) - 13230*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] -
          3675*R[3][1]*R[4][1] + 525*pow(R[4][1],2) - 1323*R[2][1]*R[5][1] + 630*R[3][1]*R[5][1] - 105*R[4][1]*R[5][1] + 126*R[2][1]*R[6][1] - 35*R[3][1]*R[6][1] +
          R[0][1]*(-1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]) - 3*R[1][1]*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1]) -
          3*R[2][1]*R[7][1]))/5. + (pow(a,8)*pow(dur,7)*(1716*pow(R[0][1],2) + 49*
           (396*pow(R[1][1],2) + 540*pow(R[2][1],2) + 25*R[3][1]*(4*R[3][1] - R[4][1]) - 3*R[2][1]*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]) - R[1][1]*(990*R[2][1] - 600*R[3][1] + 180*R[4][1] - 24*R[5][1] + R[6][1])) -
          R[0][1]*(12012*R[1][1] - 16632*R[2][1] + 11550*R[3][1] - 4200*R[4][1] + 756*R[5][1] - 56*R[6][1] + R[7][1])))/4. -
     (pow(b,8)*pow(dur,7)*(1716*pow(R[0][1],2) + 49*(396*pow(R[1][1],2) + 540*pow(R[2][1],2) + 25*R[3][1]*(4*R[3][1] - R[4][1]) - 3*R[2][1]*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]) -
             R[1][1]*(990*R[2][1] - 600*R[3][1] + 180*R[4][1] - 24*R[5][1] + R[6][1])) - R[0][1]*(12012*R[1][1] - 16632*R[2][1] + 11550*R[3][1] - 4200*R[4][1] + 756*R[5][1] - 56*R[6][1] + R[7][1])))/4. -
     (7*pow(a,9)*pow(dur,6)*(429*pow(R[0][1],2) + 6468*pow(R[1][1],2) + 7*(1890*pow(R[2][1],2) + 700*pow(R[3][1],2) + 25*pow(R[4][1],2) + 5*R[3][1]*(-70*R[4][1] + 6*R[5][1]) -
             6*R[2][1]*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1])) - 2*R[1][1]*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1]) -
          2*R[0][1]*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. +
     (7*pow(b,9)*pow(dur,6)*(429*pow(R[0][1],2) + 6468*pow(R[1][1],2) + 7*(1890*pow(R[2][1],2) + 700*pow(R[3][1],2) + 25*pow(R[4][1],2) + 5*R[3][1]*(-70*R[4][1] + 6*R[5][1]) -
             6*R[2][1]*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1])) - 2*R[1][1]*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1]) -
          2*R[0][1]*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. -
     (7*pow(a,13)*pow(dur,2)*(13*pow(R[0][1],2) + 462*pow(R[1][1],2) + 2835*pow(R[2][1],2) - 7560*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 7350*R[3][1]*R[4][1] +
          2625*pow(R[4][1],2) - 2646*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 2100*R[4][1]*R[5][1] + 378*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 700*R[3][1]*R[6][1] + 420*R[4][1]*R[6][1] - 126*R[5][1]*R[6][1] +
          7*pow(R[6][1],2) - 6*R[1][1]*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1]) - 60*R[2][1]*R[7][1] + 60*R[3][1]*R[7][1] - 30*R[4][1]*R[7][1] + 6*R[5][1]*R[7][1] -
          2*R[0][1]*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. +
     (7*pow(b,13)*pow(dur,2)*(13*pow(R[0][1],2) + 462*pow(R[1][1],2) + 2835*pow(R[2][1],2) - 7560*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 7350*R[3][1]*R[4][1] +
          2625*pow(R[4][1],2) - 2646*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 2100*R[4][1]*R[5][1] + 378*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 700*R[3][1]*R[6][1] + 420*R[4][1]*R[6][1] - 126*R[5][1]*R[6][1] +
          7*pow(R[6][1],2) - 6*R[1][1]*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1]) - 60*R[2][1]*R[7][1] + 60*R[3][1]*R[7][1] - 30*R[4][1]*R[7][1] + 6*R[5][1]*R[7][1] -
          2*R[0][1]*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. -
     (7*pow(a,11)*pow(dur,4)*(143*pow(R[0][1],2) + 3465*pow(R[1][1],2) + 13230*pow(R[2][1],2) - 26460*R[2][1]*R[3][1] + 12250*pow(R[3][1],2) + 14700*R[2][1]*R[4][1] - 12250*R[3][1]*R[4][1] +
          2625*pow(R[4][1],2) - 4410*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 63*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 70*R[4][1]*R[6][1] -
          10*R[1][1]*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1]) - 30*R[2][1]*R[7][1] + 10*R[3][1]*R[7][1] -
          2*R[0][1]*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11. +
     (7*pow(b,11)*pow(dur,4)*(143*pow(R[0][1],2) + 3465*pow(R[1][1],2) + 13230*pow(R[2][1],2) - 26460*R[2][1]*R[3][1] + 12250*pow(R[3][1],2) + 14700*R[2][1]*R[4][1] - 12250*R[3][1]*R[4][1] +
          2625*pow(R[4][1],2) - 4410*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 63*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 70*R[4][1]*R[6][1] -
          10*R[1][1]*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1]) - 30*R[2][1]*R[7][1] + 10*R[3][1]*R[7][1] -
          2*R[0][1]*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11. +
     (7*pow(a,12)*pow(dur,3)*(26*pow(R[0][1],2) + 770*pow(R[1][1],2) + 3780*pow(R[2][1],2) - 8820*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 6125*R[3][1]*R[4][1] +
          1750*pow(R[4][1],2) - 2205*R[2][1]*R[5][1] + 2100*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 126*pow(R[5][1],2) + 420*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 140*R[4][1]*R[6][1] - 21*R[5][1]*R[6][1] +
          R[0][1]*(-286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]) - 30*R[2][1]*R[7][1] + 20*R[3][1]*R[7][1] - 5*R[4][1]*R[7][1] +
          R[1][1]*(-3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1])))/6. -
     (7*pow(b,12)*pow(dur,3)*(26*pow(R[0][1],2) + 770*pow(R[1][1],2) + 3780*pow(R[2][1],2) - 8820*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 6125*R[3][1]*R[4][1] +
          1750*pow(R[4][1],2) - 2205*R[2][1]*R[5][1] + 2100*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 126*pow(R[5][1],2) + 420*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 140*R[4][1]*R[6][1] - 21*R[5][1]*R[6][1] +
          R[0][1]*(-286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]) - 30*R[2][1]*R[7][1] + 20*R[3][1]*R[7][1] - 5*R[4][1]*R[7][1] +
          R[1][1]*(-3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1])))/6.)/pow(dur,14);
}



double bezier_2d_8pts_continuity_euc(vector<double>& P, vector<double>& Q, int n, vector<double>& grad, double durf, double durg) {
  if(n == 0) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,2*(P[7*2+0] - Q[0*2+0]),
        2*(P[7*2+1] - Q[0*2+1]),-2*(P[7*2+0] - Q[0*2+0]),-2*(P[7*2+1] - Q[0*2+1]),
        0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    }
    return pow(P[7*2+0] - Q[0*2+0],2) + pow(P[7*2+1] - Q[0*2+1],2);
  } else if(n == 1) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,(-14*((-7*P[6*2+0])/durf + (7*P[7*2+0])/durf + (7*Q[0*2+0])/durg - (7*Q[1*2+0])/durg))/durf,(-14*((-7*P[6*2+1])/durf + (7*P[7*2+1])/durf + (7*Q[0*2+1])/durg - (7*Q[1*2+1])/durg))/durf,
   (14*((-7*P[6*2+0])/durf + (7*P[7*2+0])/durf + (7*Q[0*2+0])/durg - (7*Q[1*2+0])/durg))/durf,(14*((-7*P[6*2+1])/durf + (7*P[7*2+1])/durf + (7*Q[0*2+1])/durg - (7*Q[1*2+1])/durg))/durf,
   (14*((-7*P[6*2+0])/durf + (7*P[7*2+0])/durf + (7*Q[0*2+0])/durg - (7*Q[1*2+0])/durg))/durg,(14*((-7*P[6*2+1])/durf + (7*P[7*2+1])/durf + (7*Q[0*2+1])/durg - (7*Q[1*2+1])/durg))/durg,
   (-14*((-7*P[6*2+0])/durf + (7*P[7*2+0])/durf + (7*Q[0*2+0])/durg - (7*Q[1*2+0])/durg))/durg,(-14*((-7*P[6*2+1])/durf + (7*P[7*2+1])/durf + (7*Q[0*2+1])/durg - (7*Q[1*2+1])/durg))/durg,0,0,0,0,0,0,0,0,0,0,0,0};
    }
    return pow((-7*P[6*2+0])/durf + (7*P[7*2+0])/durf + (7*Q[0*2+0])/durg - (7*Q[1*2+0])/durg,2) + pow((-7*P[6*2+1])/durf + (7*P[7*2+1])/durf + (7*Q[0*2+1])/durg - (7*Q[1*2+1])/durg,2);
  } else if(n == 2) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,0,0,(84*((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2)))/
    pow(durf,2),(84*((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2)))/pow(durf,2),
   (-168*((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2)))/pow(durf,2),
   (-168*((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2)))/pow(durf,2),
   (84*((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2)))/pow(durf,2),
   (84*((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2)))/pow(durf,2),
   (-84*((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2)))/pow(durg,2),
   (-84*((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2)))/pow(durg,2),
   (168*((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2)))/pow(durg,2),
   (168*((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2)))/pow(durg,2),
   (-84*((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2)))/pow(durg,2),
   (-84*((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2)))/pow(durg,2),0,0,0,0,0,0,0,
   0,0,0};
    }
    return pow((42*P[5*2+0])/pow(durf,2) - (84*P[6*2+0])/pow(durf,2) + (42*P[7*2+0])/pow(durf,2) - (42*Q[0*2+0])/pow(durg,2) + (84*Q[1*2+0])/pow(durg,2) - (42*Q[2*2+0])/pow(durg,2),2) +
   pow((42*P[5*2+1])/pow(durf,2) - (84*P[6*2+1])/pow(durf,2) + (42*P[7*2+1])/pow(durf,2) - (42*Q[0*2+1])/pow(durg,2) + (84*Q[1*2+1])/pow(durg,2) - (42*Q[2*2+1])/pow(durg,2),2);
  } else if(n == 3) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,(-420*((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durf,3),(-420*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durf,3),(1260*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durf,3),(1260*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durf,3),(-1260*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durf,3),(-1260*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durf,3),(420*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durf,3),(420*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durf,3),(420*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durg,3),(420*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durg,3),(-1260*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durg,3),(-1260*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durg,3),(1260*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durg,3),(1260*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durg,3),(-420*
      ((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
        (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3)))/pow(durg,3),(-420*
      ((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) + (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) +
        (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3)))/pow(durg,3),0,0,0,0,0,0,0,0};
    }
    return pow((-210*P[4*2+0])/pow(durf,3) + (630*P[5*2+0])/pow(durf,3) - (630*P[6*2+0])/pow(durf,3) + (210*P[7*2+0])/pow(durf,3) + (210*Q[0*2+0])/pow(durg,3) - (630*Q[1*2+0])/pow(durg,3) +
     (630*Q[2*2+0])/pow(durg,3) - (210*Q[3*2+0])/pow(durg,3),2) + pow((-210*P[4*2+1])/pow(durf,3) + (630*P[5*2+1])/pow(durf,3) - (630*P[6*2+1])/pow(durf,3) + (210*P[7*2+1])/pow(durf,3) +
     (210*Q[0*2+1])/pow(durg,3) - (630*Q[1*2+1])/pow(durg,3) + (630*Q[2*2+1])/pow(durg,3) - (210*Q[3*2+1])/pow(durg,3),2);
  } else if(n == 4) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,(1680*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durf,4),
   (1680*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durf,4),
   (-6720*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durf,4),
   (-6720*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durf,4),
   (10080*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durf,4),
   (10080*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durf,4),
   (-6720*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durf,4),
   (-6720*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durf,4),
   (1680*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durf,4),
   (1680*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durf,4),
   (-1680*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durg,4),
   (-1680*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durg,4),
   (6720*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durg,4),
   (6720*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durg,4),
   (-10080*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durg,4),
   (-10080*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durg,4),
   (6720*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durg,4),
   (6720*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durg,4),
   (-1680*((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
        (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4)))/pow(durg,4),
   (-1680*((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
        (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4)))/pow(durg,4),0,0,0,0,0,0};
    }
    return pow((840*P[3*2+0])/pow(durf,4) - (3360*P[4*2+0])/pow(durf,4) + (5040*P[5*2+0])/pow(durf,4) - (3360*P[6*2+0])/pow(durf,4) + (840*P[7*2+0])/pow(durf,4) - (840*Q[0*2+0])/pow(durg,4) +
     (3360*Q[1*2+0])/pow(durg,4) - (5040*Q[2*2+0])/pow(durg,4) + (3360*Q[3*2+0])/pow(durg,4) - (840*Q[4*2+0])/pow(durg,4),2) +
   pow((840*P[3*2+1])/pow(durf,4) - (3360*P[4*2+1])/pow(durf,4) + (5040*P[5*2+1])/pow(durf,4) - (3360*P[6*2+1])/pow(durf,4) + (840*P[7*2+1])/pow(durf,4) - (840*Q[0*2+1])/pow(durg,4) +
     (3360*Q[1*2+1])/pow(durg,4) - (5040*Q[2*2+1])/pow(durg,4) + (3360*Q[3*2+1])/pow(durg,4) - (840*Q[4*2+1])/pow(durg,4),2);
  } else if(n == 5) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,(-5040*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durf,5),
   (-5040*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durf,5),
   (25200*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durf,5),
   (25200*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durf,5),
   (-50400*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durf,5),
   (-50400*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durf,5),
   (50400*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durf,5),
   (50400*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durf,5),
   (-25200*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durf,5),
   (-25200*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durf,5),
   (5040*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durf,5),
   (5040*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durf,5),
   (5040*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durg,5),
   (5040*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durg,5),
   (-25200*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durg,5),
   (-25200*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durg,5),
   (50400*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durg,5),
   (50400*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durg,5),
   (-50400*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durg,5),
   (-50400*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durg,5),
   (25200*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durg,5),
   (25200*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durg,5),
   (-5040*((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
        (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5)))/pow(durg,5),
   (-5040*((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
        (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5)))/pow(durg,5),
   0,0,0,0};
    }
    return pow((-2520*P[2*2+0])/pow(durf,5) + (12600*P[3*2+0])/pow(durf,5) - (25200*P[4*2+0])/pow(durf,5) + (25200*P[5*2+0])/pow(durf,5) - (12600*P[6*2+0])/pow(durf,5) + (2520*P[7*2+0])/pow(durf,5) +
     (2520*Q[0*2+0])/pow(durg,5) - (12600*Q[1*2+0])/pow(durg,5) + (25200*Q[2*2+0])/pow(durg,5) - (25200*Q[3*2+0])/pow(durg,5) + (12600*Q[4*2+0])/pow(durg,5) - (2520*Q[5*2+0])/pow(durg,5),2) +
   pow((-2520*P[2*2+1])/pow(durf,5) + (12600*P[3*2+1])/pow(durf,5) - (25200*P[4*2+1])/pow(durf,5) + (25200*P[5*2+1])/pow(durf,5) - (12600*P[6*2+1])/pow(durf,5) + (2520*P[7*2+1])/pow(durf,5) +
     (2520*Q[0*2+1])/pow(durg,5) - (12600*Q[1*2+1])/pow(durg,5) + (25200*Q[2*2+1])/pow(durg,5) - (25200*Q[3*2+1])/pow(durg,5) + (12600*Q[4*2+1])/pow(durg,5) - (2520*Q[5*2+1])/pow(durg,5),2);
  } else if(n == 6) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,(10080*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (10080*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (-60480*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (-60480*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (151200*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (151200*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (-201600*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (-201600*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (151200*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (151200*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (-60480*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (-60480*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (10080*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durf,6),
   (10080*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durf,6),
   (-10080*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (-10080*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),
   (60480*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (60480*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),
   (-151200*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (-151200*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),
   (201600*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (201600*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),
   (-151200*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (-151200*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),
   (60480*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (60480*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),
   (-10080*((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
        (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
        (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6)))/pow(durg,6),
   (-10080*((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) + (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) +
        (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) + (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) +
        (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6)))/pow(durg,6),0,0};
    }
    return pow((5040*P[1*2+0])/pow(durf,6) - (30240*P[2*2+0])/pow(durf,6) + (75600*P[3*2+0])/pow(durf,6) - (100800*P[4*2+0])/pow(durf,6) + (75600*P[5*2+0])/pow(durf,6) - (30240*P[6*2+0])/pow(durf,6) +
     (5040*P[7*2+0])/pow(durf,6) - (5040*Q[0*2+0])/pow(durg,6) + (30240*Q[1*2+0])/pow(durg,6) - (75600*Q[2*2+0])/pow(durg,6) + (100800*Q[3*2+0])/pow(durg,6) - (75600*Q[4*2+0])/pow(durg,6) +
     (30240*Q[5*2+0])/pow(durg,6) - (5040*Q[6*2+0])/pow(durg,6),2) + pow((5040*P[1*2+1])/pow(durf,6) - (30240*P[2*2+1])/pow(durf,6) + (75600*P[3*2+1])/pow(durf,6) - (100800*P[4*2+1])/pow(durf,6) +
     (75600*P[5*2+1])/pow(durf,6) - (30240*P[6*2+1])/pow(durf,6) + (5040*P[7*2+1])/pow(durf,6) - (5040*Q[0*2+1])/pow(durg,6) + (30240*Q[1*2+1])/pow(durg,6) - (75600*Q[2*2+1])/pow(durg,6) +
     (100800*Q[3*2+1])/pow(durg,6) - (75600*Q[4*2+1])/pow(durg,6) + (30240*Q[5*2+1])/pow(durg,6) - (5040*Q[6*2+1])/pow(durg,6),2);
  } else if(n == 7) {
    if(grad.size() > 0) {
      grad = vector<double>{(-10080*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (-10080*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (70560*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (70560*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (-211680*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (-211680*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (352800*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (352800*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (-352800*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (-352800*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (211680*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (211680*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (-70560*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (-70560*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (10080*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durf,7),
   (10080*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durf,7),
   (10080*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (10080*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (-70560*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (-70560*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (211680*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (211680*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (-352800*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (-352800*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (352800*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (352800*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (-211680*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (-211680*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (70560*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (70560*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7),
   (-10080*((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
        (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
        (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7)))/pow(durg,7),
   (-10080*((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
        (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
        (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7)))/pow(durg,7)};
    }
    return pow((-5040*P[0*2+0])/pow(durf,7) + (35280*P[1*2+0])/pow(durf,7) - (105840*P[2*2+0])/pow(durf,7) + (176400*P[3*2+0])/pow(durf,7) - (176400*P[4*2+0])/pow(durf,7) + (105840*P[5*2+0])/pow(durf,7) -
     (35280*P[6*2+0])/pow(durf,7) + (5040*P[7*2+0])/pow(durf,7) + (5040*Q[0*2+0])/pow(durg,7) - (35280*Q[1*2+0])/pow(durg,7) + (105840*Q[2*2+0])/pow(durg,7) - (176400*Q[3*2+0])/pow(durg,7) +
     (176400*Q[4*2+0])/pow(durg,7) - (105840*Q[5*2+0])/pow(durg,7) + (35280*Q[6*2+0])/pow(durg,7) - (5040*Q[7*2+0])/pow(durg,7),2) +
   pow((-5040*P[0*2+1])/pow(durf,7) + (35280*P[1*2+1])/pow(durf,7) - (105840*P[2*2+1])/pow(durf,7) + (176400*P[3*2+1])/pow(durf,7) - (176400*P[4*2+1])/pow(durf,7) + (105840*P[5*2+1])/pow(durf,7) -
     (35280*P[6*2+1])/pow(durf,7) + (5040*P[7*2+1])/pow(durf,7) + (5040*Q[0*2+1])/pow(durg,7) - (35280*Q[1*2+1])/pow(durg,7) + (105840*Q[2*2+1])/pow(durg,7) - (176400*Q[3*2+1])/pow(durg,7) +
     (176400*Q[4*2+1])/pow(durg,7) - (105840*Q[5*2+1])/pow(durg,7) + (35280*Q[6*2+1])/pow(durg,7) - (5040*Q[7*2+1])/pow(durg,7),2);
  }

  if(grad.size() > 0) {
    grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  }
  return 0;
}

double bezier_2d_8pts_distance_from_plane(vector<vectoreuc>& P, hyperplane& plane, vector<double>& grad, double t) {
  vectoreuc& n = plane.normal;
  double planedist = plane.distance;

  if(grad.size() > 0) {
    grad = vector<double>{pow(1 - t,7)*n[0],pow(1 - t,7)*n[1],7*pow(1 - t,6)*t*n[0],
   7*pow(1 - t,6)*t*n[1],21*pow(1 - t,5)*pow(t,2)*n[0],
   21*pow(1 - t,5)*pow(t,2)*n[1],35*pow(1 - t,4)*pow(t,3)*n[0],
   35*pow(1 - t,4)*pow(t,3)*n[1],35*pow(1 - t,3)*pow(t,4)*n[0],
   35*pow(1 - t,3)*pow(t,4)*n[1],21*pow(1 - t,2)*pow(t,5)*n[0],
   21*pow(1 - t,2)*pow(t,5)*n[1],7*(1 - t)*pow(t,6)*n[0],
   7*(1 - t)*pow(t,6)*n[1],pow(t,7)*n[0],pow(t,7)*n[1]};
  }

  return -planedist + n[0]*(pow(1 - t,7)*P[0][0] + 7*pow(1 - t,6)*t*P[1][0] +
      21*pow(1 - t,5)*pow(t,2)*P[2][0] + 35*pow(1 - t,4)*pow(t,3)*P[3][0] +
      35*pow(1 - t,3)*pow(t,4)*P[4][0] + 21*pow(1 - t,2)*pow(t,5)*P[5][0] +
      7*(1 - t)*pow(t,6)*P[6][0] + pow(t,7)*P[7][0]) +
   n[1]*(pow(1 - t,7)*P[0][1] + 7*pow(1 - t,6)*t*P[1][1] +
      21*pow(1 - t,5)*pow(t,2)*P[2][1] + 35*pow(1 - t,4)*pow(t,3)*P[3][1] +
      35*pow(1 - t,3)*pow(t,4)*P[4][1] + 21*pow(1 - t,2)*pow(t,5)*P[5][1] +
      7*(1 - t)*pow(t,6)*P[6][1] + pow(t,7)*P[7][1]);
}


double bezier_2d_8pts_ndistance_from_point(vector<double>& P, vectoreuc& C, vector<double>& grad, double T, int degree, double dur) {
  if(degree == 0) {
    if(grad.size() > 0) {
      grad = vector<double>{
        2*pow(1 - T/dur,7)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
      (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
      (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)),
   2*pow(1 - T/dur,7)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
      (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
      (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)),
   (14*T*pow(1 - T/dur,6)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/dur,
   (14*T*pow(1 - T/dur,6)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/dur,
   (42*pow(T,2)*pow(1 - T/dur,5)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/pow(dur,2),
   (42*pow(T,2)*pow(1 - T/dur,5)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/pow(dur,2),
   (70*pow(T,3)*pow(1 - T/dur,4)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/pow(dur,3),
   (70*pow(T,3)*pow(1 - T/dur,4)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/pow(dur,3),
   (70*pow(T,4)*pow(1 - T/dur,3)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/pow(dur,4),
   (70*pow(T,4)*pow(1 - T/dur,3)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/pow(dur,4),
   (42*pow(T,5)*pow(1 - T/dur,2)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/pow(dur,5),
   (42*pow(T,5)*pow(1 - T/dur,2)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/pow(dur,5),
   (14*pow(T,6)*(1 - T/dur)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/pow(dur,6),
   (14*pow(T,6)*(1 - T/dur)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/pow(dur,6),
   (2*pow(T,7)*(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) + (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
        (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) + (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7)))/
    pow(dur,7),(2*pow(T,7)*(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7)))/pow(dur,7)
      };
    }

    return pow(-C[0] + pow(1 - T/dur,7)*P[0*2+0] + (7*T*pow(1 - T/dur,6)*P[1*2+0])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) + (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
     (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) + (7*pow(T,6)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (pow(T,7)*P[7*2+0])/pow(dur,7),2) +
   pow(-C[1] + pow(1 - T/dur,7)*P[0*2+1] + (7*T*pow(1 - T/dur,6)*P[1*2+1])/dur + (21*pow(T,2)*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) + (35*pow(T,3)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
     (35*pow(T,4)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(T,5)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) + (7*pow(T,6)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (pow(T,7)*P[7*2+1])/pow(dur,7),2);
   } else if(degree == 1) {
      if(grad.size() > 0) {
        grad = vector<double> {
          (-14*pow(1 - T/dur,6)*(-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur -
        (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
        (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) -
        (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
        (7*pow(T,6)*P[7*2+0])/pow(dur,7)))/dur,(-14*pow(1 - T/dur,6)*(-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur -
        (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
        (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) -
        (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
        (7*pow(T,6)*P[7*2+1])/pow(dur,7)))/dur,2*((-42*T*pow(1 - T/dur,5))/pow(dur,2) + (7*pow(1 - T/dur,6))/dur)*
    (-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7)),
   2*((-42*T*pow(1 - T/dur,5))/pow(dur,2) + (7*pow(1 - T/dur,6))/dur)*(-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur -
      (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
      (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) -
      (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
      (7*pow(T,6)*P[7*2+1])/pow(dur,7)),2*((-105*pow(T,2)*pow(1 - T/dur,4))/pow(dur,3) + (42*T*pow(1 - T/dur,5))/pow(dur,2))*
    (-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7)),
   2*((-105*pow(T,2)*pow(1 - T/dur,4))/pow(dur,3) + (42*T*pow(1 - T/dur,5))/pow(dur,2))*
    (-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7)),
   2*((-140*pow(T,3)*pow(1 - T/dur,3))/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4))/pow(dur,3))*
    (-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7)),
   2*((-140*pow(T,3)*pow(1 - T/dur,3))/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4))/pow(dur,3))*
    (-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7)),
   2*((-105*pow(T,4)*pow(1 - T/dur,2))/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3))/pow(dur,4))*
    (-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7)),
   2*((-105*pow(T,4)*pow(1 - T/dur,2))/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3))/pow(dur,4))*
    (-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7)),
   2*((-42*pow(T,5)*(1 - T/dur))/pow(dur,6) + (105*pow(T,4)*pow(1 - T/dur,2))/pow(dur,5))*
    (-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7)),
   2*((-42*pow(T,5)*(1 - T/dur))/pow(dur,6) + (105*pow(T,4)*pow(1 - T/dur,2))/pow(dur,5))*
    (-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7)),
   2*((-7*pow(T,6))/pow(dur,7) + (42*pow(T,5)*(1 - T/dur))/pow(dur,6))*(-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
      (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
      (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) -
      (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
      (7*pow(T,6)*P[7*2+0])/pow(dur,7)),2*((-7*pow(T,6))/pow(dur,7) + (42*pow(T,5)*(1 - T/dur))/pow(dur,6))*
    (-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7)),
   (14*pow(T,6)*(-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
        (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
        (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
        (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
   (14*pow(T,6)*(-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
        (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
        (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
        (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7)))/pow(dur,7)
        };

        return pow(-C[0] - (7*pow(1 - T/dur,6)*P[0*2+0])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+0])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) +
     (42*T*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) -
     (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
     (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(T,6)*P[6*2+0])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (7*pow(T,6)*P[7*2+0])/pow(dur,7),2) +
   pow(-C[1] - (7*pow(1 - T/dur,6)*P[0*2+1])/dur - (42*T*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - T/dur,6)*P[1*2+1])/dur - (105*pow(T,2)*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) +
     (42*T*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(T,3)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(T,2)*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) -
     (105*pow(T,4)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(T,3)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(T,5)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
     (105*pow(T,4)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(T,6)*P[6*2+1])/pow(dur,7) + (42*pow(T,5)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (7*pow(T,6)*P[7*2+1])/pow(dur,7),2);
      }
   } else if(degree == 2) {
     if(grad.size() > 0) {
       grad = vector<double> {
         (84*pow(1 - T/dur,5)*(-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
                 (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
                 (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
                 (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
                 (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
                 (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)))/pow(dur,2),
            (84*pow(1 - T/dur,5)*(-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
                 (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
                 (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
                 (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
                 (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
                 (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)))/pow(dur,2),
            2*((210*T*pow(1 - T/dur,4))/pow(dur,3) - (84*pow(1 - T/dur,5))/pow(dur,2))*
             (-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)),
            2*((210*T*pow(1 - T/dur,4))/pow(dur,3) - (84*pow(1 - T/dur,5))/pow(dur,2))*
             (-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)),
            2*((420*pow(T,2)*pow(1 - T/dur,3))/pow(dur,4) - (420*T*pow(1 - T/dur,4))/pow(dur,3) + (42*pow(1 - T/dur,5))/pow(dur,2))*
             (-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)),
            2*((420*pow(T,2)*pow(1 - T/dur,3))/pow(dur,4) - (420*T*pow(1 - T/dur,4))/pow(dur,3) + (42*pow(1 - T/dur,5))/pow(dur,2))*
             (-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)),
            2*((420*pow(T,3)*pow(1 - T/dur,2))/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3))/pow(dur,4) + (210*T*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)),
            2*((420*pow(T,3)*pow(1 - T/dur,2))/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3))/pow(dur,4) + (210*T*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)),
            2*((210*pow(T,4)*(1 - T/dur))/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2))/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)),
            2*((210*pow(T,4)*(1 - T/dur))/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2))/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)),
            2*((42*pow(T,5))/pow(dur,7) - (420*pow(T,4)*(1 - T/dur))/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)),
            2*((42*pow(T,5))/pow(dur,7) - (420*pow(T,4)*(1 - T/dur))/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
               (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)),
            2*((-84*pow(T,5))/pow(dur,7) + (210*pow(T,4)*(1 - T/dur))/pow(dur,6))*(-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
               (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)),
            2*((-84*pow(T,5))/pow(dur,7) + (210*pow(T,4)*(1 - T/dur))/pow(dur,6))*(-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
               (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
               (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
               (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
               (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
               (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)),
            (84*pow(T,5)*(-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
                 (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
                 (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
                 (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
                 (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
                 (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
            (84*pow(T,5)*(-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
                 (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
                 (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
                 (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
                 (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
                 (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7)))/pow(dur,7)
       };

       return pow(-C[0] + (42*pow(1 - T/dur,5)*P[0*2+0])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+0])/pow(dur,2) +
     (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+0])/pow(dur,2) +
     (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) +
     (210*pow(T,4)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) +
     (42*pow(T,5)*P[5*2+0])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(T,5)*P[6*2+0])/pow(dur,7) +
     (210*pow(T,4)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (42*pow(T,5)*P[7*2+0])/pow(dur,7),2) +
   pow(-C[1] + (42*pow(1 - T/dur,5)*P[0*2+1])/pow(dur,2) + (210*T*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - T/dur,5)*P[1*2+1])/pow(dur,2) +
     (420*pow(T,2)*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (420*T*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - T/dur,5)*P[2*2+1])/pow(dur,2) +
     (420*pow(T,3)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(T,2)*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*T*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) +
     (210*pow(T,4)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (840*pow(T,3)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(T,2)*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) +
     (42*pow(T,5)*P[5*2+1])/pow(dur,7) - (420*pow(T,4)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (420*pow(T,3)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(T,5)*P[6*2+1])/pow(dur,7) +
     (210*pow(T,4)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (42*pow(T,5)*P[7*2+1])/pow(dur,7),2);
     }
   } else if(degree == 3) {
     if(grad.size() > 0) {
       grad = vector<double> {
         (-420*pow(1 - T/dur,4)*(-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
                 (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
                 (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
                 (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)))/
             pow(dur,3),(-420*pow(1 - T/dur,4)*(-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
                 (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
                 (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
                 (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)))/
             pow(dur,3),2*((-840*T*pow(1 - T/dur,3))/pow(dur,4) + (630*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)),
            2*((-840*T*pow(1 - T/dur,3))/pow(dur,4) + (630*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)),
            2*((-1260*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5) + (2520*T*pow(1 - T/dur,3))/pow(dur,4) - (630*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)),
            2*((-1260*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5) + (2520*T*pow(1 - T/dur,3))/pow(dur,4) - (630*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)),
            2*((-840*pow(T,3)*(1 - T/dur))/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5) - (2520*T*pow(1 - T/dur,3))/pow(dur,4) + (210*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)),
            2*((-840*pow(T,3)*(1 - T/dur))/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5) - (2520*T*pow(1 - T/dur,3))/pow(dur,4) + (210*pow(1 - T/dur,4))/pow(dur,3))*
             (-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)),
            2*((-210*pow(T,4))/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur))/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5) + (840*T*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)),
            2*((-210*pow(T,4))/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur))/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5) + (840*T*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)),
            2*((630*pow(T,4))/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur))/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)),
            2*((630*pow(T,4))/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur))/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
               (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
               (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
               (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)),
            2*((-630*pow(T,4))/pow(dur,7) + (840*pow(T,3)*(1 - T/dur))/pow(dur,6))*(-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) - (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) -
               (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) - (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) -
               (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) + (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) -
               (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)),
            2*((-630*pow(T,4))/pow(dur,7) + (840*pow(T,3)*(1 - T/dur))/pow(dur,6))*(-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) - (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) -
               (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) - (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) -
               (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) + (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) -
               (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
               (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)),
            (420*pow(T,4)*(-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
                 (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
                 (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
                 (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7)))/
             pow(dur,7),(420*pow(T,4)*(-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
                 (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
                 (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
                 (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
                 (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7)))/
             pow(dur,7)
       };

       return pow(-C[0] - (210*pow(1 - T/dur,4)*P[0*2+0])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+0])/pow(dur,3) -
     (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+0])/pow(dur,3) -
     (840*pow(T,3)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) +
     (210*pow(1 - T/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(T,4)*P[4*2+0])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
     (840*T*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(T,4)*P[5*2+0])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
     (630*pow(T,4)*P[6*2+0])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (210*pow(T,4)*P[7*2+0])/pow(dur,7),2) +
   pow(-C[1] - (210*pow(1 - T/dur,4)*P[0*2+1])/pow(dur,3) - (840*T*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - T/dur,4)*P[1*2+1])/pow(dur,3) -
     (1260*pow(T,2)*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (2520*T*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - T/dur,4)*P[2*2+1])/pow(dur,3) -
     (840*pow(T,3)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(T,2)*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (2520*T*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) +
     (210*pow(1 - T/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(T,4)*P[4*2+1])/pow(dur,7) + (2520*pow(T,3)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(T,2)*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
     (840*T*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(T,4)*P[5*2+1])/pow(dur,7) - (2520*pow(T,3)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(T,2)*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
     (630*pow(T,4)*P[6*2+1])/pow(dur,7) + (840*pow(T,3)*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (210*pow(T,4)*P[7*2+1])/pow(dur,7),2);
     }
   } else if(degree == 4) {
     if(grad.size() > 0) {
       grad = vector<double> {
         (1680*pow(1 - T/dur,3)*(-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
                 (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
                 (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
                 (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
                 (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
                 (840*pow(T,3)*P[7*2+0])/pow(dur,7)))/pow(dur,4),(1680*pow(1 - T/dur,3)*
               (-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
                 (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
                 (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
                 (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
                 (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
                 (840*pow(T,3)*P[7*2+1])/pow(dur,7)))/pow(dur,4),2*((2520*T*pow(1 - T/dur,2))/pow(dur,5) - (3360*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+0])/pow(dur,7)),2*((2520*T*pow(1 - T/dur,2))/pow(dur,5) - (3360*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+1])/pow(dur,7)),2*((2520*pow(T,2)*(1 - T/dur))/pow(dur,6) - (10080*T*pow(1 - T/dur,2))/pow(dur,5) + (5040*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+0])/pow(dur,7)),2*((2520*pow(T,2)*(1 - T/dur))/pow(dur,6) - (10080*T*pow(1 - T/dur,2))/pow(dur,5) + (5040*pow(1 - T/dur,3))/pow(dur,4))*
             (-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+1])/pow(dur,7)),2*((840*pow(T,3))/pow(dur,7) - (10080*pow(T,2)*(1 - T/dur))/pow(dur,6) + (15120*T*pow(1 - T/dur,2))/pow(dur,5) -
               (3360*pow(1 - T/dur,3))/pow(dur,4))*(-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+0])/pow(dur,7)),2*((840*pow(T,3))/pow(dur,7) - (10080*pow(T,2)*(1 - T/dur))/pow(dur,6) + (15120*T*pow(1 - T/dur,2))/pow(dur,5) -
               (3360*pow(1 - T/dur,3))/pow(dur,4))*(-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+1])/pow(dur,7)),2*((-3360*pow(T,3))/pow(dur,7) + (15120*pow(T,2)*(1 - T/dur))/pow(dur,6) - (10080*T*pow(1 - T/dur,2))/pow(dur,5) +
               (840*pow(1 - T/dur,3))/pow(dur,4))*(-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+0])/pow(dur,7)),2*((-3360*pow(T,3))/pow(dur,7) + (15120*pow(T,2)*(1 - T/dur))/pow(dur,6) - (10080*T*pow(1 - T/dur,2))/pow(dur,5) +
               (840*pow(1 - T/dur,3))/pow(dur,4))*(-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+1])/pow(dur,7)),2*((5040*pow(T,3))/pow(dur,7) - (10080*pow(T,2)*(1 - T/dur))/pow(dur,6) + (2520*T*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+0])/pow(dur,7)),2*((5040*pow(T,3))/pow(dur,7) - (10080*pow(T,2)*(1 - T/dur))/pow(dur,6) + (2520*T*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+1])/pow(dur,7)),2*((-3360*pow(T,3))/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur))/pow(dur,6))*
             (-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+0])/pow(dur,7)),2*((-3360*pow(T,3))/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
               (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
               (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
               (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
               (840*pow(T,3)*P[7*2+1])/pow(dur,7)),(1680*pow(T,3)*(-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) -
                 (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) +
                 (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) - (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) -
                 (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) + (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
                 (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) - (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
                 (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (840*pow(T,3)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
            (1680*pow(T,3)*(-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
                 (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
                 (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
                 (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
                 (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
                 (840*pow(T,3)*P[7*2+1])/pow(dur,7)))/pow(dur,7)
       };

       return pow(-C[0] + (840*pow(1 - T/dur,3)*P[0*2+0])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+0])/pow(dur,4) +
     (2520*pow(T,2)*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(T,3)*P[3*2+0])/pow(dur,7) -
     (10080*pow(T,2)*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(T,3)*P[4*2+0])/pow(dur,7) +
     (15120*pow(T,2)*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(T,3)*P[5*2+0])/pow(dur,7) -
     (10080*pow(T,2)*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(T,3)*P[6*2+0])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
     (840*pow(T,3)*P[7*2+0])/pow(dur,7),2) + pow(-C[1] + (840*pow(1 - T/dur,3)*P[0*2+1])/pow(dur,4) + (2520*T*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[1*2+1])/pow(dur,4) +
     (2520*pow(T,2)*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - T/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(T,3)*P[3*2+1])/pow(dur,7) -
     (10080*pow(T,2)*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (15120*T*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - T/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(T,3)*P[4*2+1])/pow(dur,7) +
     (15120*pow(T,2)*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (10080*T*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - T/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(T,3)*P[5*2+1])/pow(dur,7) -
     (10080*pow(T,2)*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*T*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(T,3)*P[6*2+1])/pow(dur,7) + (2520*pow(T,2)*(1 - T/dur)*P[6*2+1])/pow(dur,6) +
     (840*pow(T,3)*P[7*2+1])/pow(dur,7),2);
     }
   } else if(degree == 5) {
     if(grad.size() > 0) {
       grad = vector<double> {
         (-5040*pow(1 - T/dur,2)*(-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) -
                 (2520*pow(T,2)*P[2*2+0])/pow(dur,7) + (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) -
                 (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) -
                 (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
                 (12600*pow(T,2)*P[6*2+0])/pow(dur,7) + (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)))/pow(dur,5),
            (-5040*pow(1 - T/dur,2)*(-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) -
                 (2520*pow(T,2)*P[2*2+1])/pow(dur,7) + (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) -
                 (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) -
                 (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
                 (12600*pow(T,2)*P[6*2+1])/pow(dur,7) + (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)))/pow(dur,5),
            2*((-5040*T*(1 - T/dur))/pow(dur,6) + (12600*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)),
            2*((-5040*T*(1 - T/dur))/pow(dur,6) + (12600*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)),
            2*((-2520*pow(T,2))/pow(dur,7) + (25200*T*(1 - T/dur))/pow(dur,6) - (25200*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)),
            2*((-2520*pow(T,2))/pow(dur,7) + (25200*T*(1 - T/dur))/pow(dur,6) - (25200*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)),
            2*((12600*pow(T,2))/pow(dur,7) - (50400*T*(1 - T/dur))/pow(dur,6) + (25200*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)),
            2*((12600*pow(T,2))/pow(dur,7) - (50400*T*(1 - T/dur))/pow(dur,6) + (25200*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)),
            2*((-25200*pow(T,2))/pow(dur,7) + (50400*T*(1 - T/dur))/pow(dur,6) - (12600*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)),
            2*((-25200*pow(T,2))/pow(dur,7) + (50400*T*(1 - T/dur))/pow(dur,6) - (12600*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)),
            2*((25200*pow(T,2))/pow(dur,7) - (25200*T*(1 - T/dur))/pow(dur,6) + (2520*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)),
            2*((25200*pow(T,2))/pow(dur,7) - (25200*T*(1 - T/dur))/pow(dur,6) + (2520*pow(1 - T/dur,2))/pow(dur,5))*
             (-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) +
               (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) +
               (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
               (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) +
               (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)),
            2*((-12600*pow(T,2))/pow(dur,7) + (5040*T*(1 - T/dur))/pow(dur,6))*(-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) +
               (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) + (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) +
               (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) +
               (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) +
               (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) + (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)),
            2*((-12600*pow(T,2))/pow(dur,7) + (5040*T*(1 - T/dur))/pow(dur,6))*(-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) +
               (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) + (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) +
               (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) +
               (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) +
               (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) + (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)),
            (5040*pow(T,2)*(-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) -
                 (2520*pow(T,2)*P[2*2+0])/pow(dur,7) + (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) -
                 (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) + (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) -
                 (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) + (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) -
                 (12600*pow(T,2)*P[6*2+0])/pow(dur,7) + (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
            (5040*pow(T,2)*(-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) -
                 (2520*pow(T,2)*P[2*2+1])/pow(dur,7) + (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) -
                 (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) + (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) -
                 (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) + (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) -
                 (12600*pow(T,2)*P[6*2+1])/pow(dur,7) + (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7)))/pow(dur,7)
       };

       return pow(-C[0] - (2520*pow(1 - T/dur,2)*P[0*2+0])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(T,2)*P[2*2+0])/pow(dur,7) +
     (25200*T*(1 - T/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(T,2)*P[3*2+0])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+0])/pow(dur,6) +
     (25200*pow(1 - T/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(T,2)*P[4*2+0])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+0])/pow(dur,5) +
     (25200*pow(T,2)*P[5*2+0])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(T,2)*P[6*2+0])/pow(dur,7) +
     (5040*T*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(T,2)*P[7*2+0])/pow(dur,7),2) +
   pow(-C[1] - (2520*pow(1 - T/dur,2)*P[0*2+1])/pow(dur,5) - (5040*T*(1 - T/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - T/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(T,2)*P[2*2+1])/pow(dur,7) +
     (25200*T*(1 - T/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - T/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(T,2)*P[3*2+1])/pow(dur,7) - (50400*T*(1 - T/dur)*P[3*2+1])/pow(dur,6) +
     (25200*pow(1 - T/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(T,2)*P[4*2+1])/pow(dur,7) + (50400*T*(1 - T/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - T/dur,2)*P[4*2+1])/pow(dur,5) +
     (25200*pow(T,2)*P[5*2+1])/pow(dur,7) - (25200*T*(1 - T/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - T/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(T,2)*P[6*2+1])/pow(dur,7) +
     (5040*T*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(T,2)*P[7*2+1])/pow(dur,7),2);
     }
   } else if(degree == 6) {
     if(grad.size() > 0) {
       grad = vector<double> {
         (10080*(1 - T/dur)*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) - (30240*T*P[2*2+0])/pow(dur,7) +
                 (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) +
                 (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (5040*T*P[7*2+0])/pow(dur,7)))/pow(dur,6),
            (10080*(1 - T/dur)*(-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) +
                 (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) + (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) +
                 (75600*T*P[5*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)))/pow(dur,6),
            2*((5040*T)/pow(dur,7) - (30240*(1 - T/dur))/pow(dur,6))*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) -
               (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) +
               (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (5040*T*P[7*2+0])/pow(dur,7)),2*((5040*T)/pow(dur,7) - (30240*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
               (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
               (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)),
            2*((-30240*T)/pow(dur,7) + (75600*(1 - T/dur))/pow(dur,6))*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) -
               (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) +
               (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (5040*T*P[7*2+0])/pow(dur,7)),2*((-30240*T)/pow(dur,7) + (75600*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
               (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
               (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)),
            2*((75600*T)/pow(dur,7) - (100800*(1 - T/dur))/pow(dur,6))*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) -
               (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) +
               (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (5040*T*P[7*2+0])/pow(dur,7)),2*((75600*T)/pow(dur,7) - (100800*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
               (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
               (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)),
            2*((-100800*T)/pow(dur,7) + (75600*(1 - T/dur))/pow(dur,6))*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) -
               (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) +
               (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (5040*T*P[7*2+0])/pow(dur,7)),2*((-100800*T)/pow(dur,7) + (75600*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
               (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
               (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)),
            2*((75600*T)/pow(dur,7) - (30240*(1 - T/dur))/pow(dur,6))*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) -
               (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) +
               (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (5040*T*P[7*2+0])/pow(dur,7)),2*((75600*T)/pow(dur,7) - (30240*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
               (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
               (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)),
            2*((-30240*T)/pow(dur,7) + (5040*(1 - T/dur))/pow(dur,6))*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) -
               (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) +
               (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) +
               (5040*T*P[7*2+0])/pow(dur,7)),2*((-30240*T)/pow(dur,7) + (5040*(1 - T/dur))/pow(dur,6))*
             (-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
               (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
               (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)),
            (10080*T*(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) - (30240*T*P[2*2+0])/pow(dur,7) +
                 (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) + (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) +
                 (75600*T*P[5*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (5040*T*P[7*2+0])/pow(dur,7)))/pow(dur,7),
            (10080*T*(-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) +
                 (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) + (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) +
                 (75600*T*P[5*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7)))/pow(dur,7)
       };

       return pow(-C[0] + (5040*(1 - T/dur)*P[0*2+0])/pow(dur,6) + (5040*T*P[1*2+0])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+0])/pow(dur,6) - (30240*T*P[2*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+0])/pow(dur,6) +
     (75600*T*P[3*2+0])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+0])/pow(dur,6) - (100800*T*P[4*2+0])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+0])/pow(dur,6) + (75600*T*P[5*2+0])/pow(dur,7) -
     (30240*(1 - T/dur)*P[5*2+0])/pow(dur,6) - (30240*T*P[6*2+0])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+0])/pow(dur,6) + (5040*T*P[7*2+0])/pow(dur,7),2) +
   pow(-C[1] + (5040*(1 - T/dur)*P[0*2+1])/pow(dur,6) + (5040*T*P[1*2+1])/pow(dur,7) - (30240*(1 - T/dur)*P[1*2+1])/pow(dur,6) - (30240*T*P[2*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[2*2+1])/pow(dur,6) +
     (75600*T*P[3*2+1])/pow(dur,7) - (100800*(1 - T/dur)*P[3*2+1])/pow(dur,6) - (100800*T*P[4*2+1])/pow(dur,7) + (75600*(1 - T/dur)*P[4*2+1])/pow(dur,6) + (75600*T*P[5*2+1])/pow(dur,7) -
     (30240*(1 - T/dur)*P[5*2+1])/pow(dur,6) - (30240*T*P[6*2+1])/pow(dur,7) + (5040*(1 - T/dur)*P[6*2+1])/pow(dur,6) + (5040*T*P[7*2+1])/pow(dur,7),2);
     }
   } else if(degree == 7) {
     if(grad.size() > 0) {
       grad = vector<double> {
         (-10080*(-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-10080*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(70560*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(70560*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(-211680*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-211680*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(352800*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(352800*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(-352800*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-352800*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(211680*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(211680*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(-70560*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-70560*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(10080*
               (-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
                 (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(10080*
               (-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
                 (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7)
       };

       return pow(-C[0] - (5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
     (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7),2) + pow(-C[1] - (5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) -
     (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) - (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7),2);
     }
   } else {
     if(grad.size() > 0) {
       grad = vector<double> {
        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
       };

       return pow(C[0],2) + pow(C[1],2);
     }
   }
}

double bezier_2d_8pts_neval_l2normsq(vector<double>& P, vector<double>& grad, double t, int n, double dur) {
  if(n==0) {
    if(grad.size() > 0) {
      grad = vector<double>{2*pow(1 - t/dur,7)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
      (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
      (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)),
   2*pow(1 - t/dur,7)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) +
      (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) + (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)),
   (14*t*pow(1 - t/dur,6)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/dur,
   (14*t*pow(1 - t/dur,6)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/dur,
   (42*pow(t,2)*pow(1 - t/dur,5)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/pow(dur,2),
   (42*pow(t,2)*pow(1 - t/dur,5)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/pow(dur,2),
   (70*pow(t,3)*pow(1 - t/dur,4)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/pow(dur,3),
   (70*pow(t,3)*pow(1 - t/dur,4)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/pow(dur,3),
   (70*pow(t,4)*pow(1 - t/dur,3)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/pow(dur,4),
   (70*pow(t,4)*pow(1 - t/dur,3)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/pow(dur,4),
   (42*pow(t,5)*pow(1 - t/dur,2)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/pow(dur,5),
   (42*pow(t,5)*pow(1 - t/dur,2)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/pow(dur,5),
   (14*pow(t,6)*(1 - t/dur)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/pow(dur,6),
   (14*pow(t,6)*(1 - t/dur)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/pow(dur,6),
   (2*pow(t,7)*(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) +
        (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) + (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7)))/
    pow(dur,7),(2*pow(t,7)*(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) +
        (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow(pow(1 - t/dur,7)*P[0*2+0] + (7*t*pow(1 - t/dur,6)*P[1*2+0])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) +
     (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) + (7*pow(t,6)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (pow(t,7)*P[7*2+0])/pow(dur,7),2) +
   pow(pow(1 - t/dur,7)*P[0*2+1] + (7*t*pow(1 - t/dur,6)*P[1*2+1])/dur + (21*pow(t,2)*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (35*pow(t,3)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) +
     (35*pow(t,4)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (21*pow(t,5)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) + (7*pow(t,6)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (pow(t,7)*P[7*2+1])/pow(dur,7),2);
  } else if(n==1) {
    if(grad.size()>0) {
      grad = vector<double> {(-14*pow(1 - t/dur,6)*((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur -
        (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
        (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) -
        (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
        (7*pow(t,6)*P[7*2+0])/pow(dur,7)))/dur,(-14*pow(1 - t/dur,6)*((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur -
        (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
        (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) -
        (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
        (7*pow(t,6)*P[7*2+1])/pow(dur,7)))/dur,2*((-42*t*pow(1 - t/dur,5))/pow(dur,2) + (7*pow(1 - t/dur,6))/dur)*
    ((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7)),
   2*((-42*t*pow(1 - t/dur,5))/pow(dur,2) + (7*pow(1 - t/dur,6))/dur)*((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur -
      (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
      (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) -
      (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (7*pow(t,6)*P[7*2+1])/pow(dur,7)),2*((-105*pow(t,2)*pow(1 - t/dur,4))/pow(dur,3) + (42*t*pow(1 - t/dur,5))/pow(dur,2))*
    ((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7)),
   2*((-105*pow(t,2)*pow(1 - t/dur,4))/pow(dur,3) + (42*t*pow(1 - t/dur,5))/pow(dur,2))*
    ((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7)),
   2*((-140*pow(t,3)*pow(1 - t/dur,3))/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4))/pow(dur,3))*
    ((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7)),
   2*((-140*pow(t,3)*pow(1 - t/dur,3))/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4))/pow(dur,3))*
    ((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7)),
   2*((-105*pow(t,4)*pow(1 - t/dur,2))/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3))/pow(dur,4))*
    ((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7)),
   2*((-105*pow(t,4)*pow(1 - t/dur,2))/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3))/pow(dur,4))*
    ((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7)),
   2*((-42*pow(t,5)*(1 - t/dur))/pow(dur,6) + (105*pow(t,4)*pow(1 - t/dur,2))/pow(dur,5))*
    ((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7)),
   2*((-42*pow(t,5)*(1 - t/dur))/pow(dur,6) + (105*pow(t,4)*pow(1 - t/dur,2))/pow(dur,5))*
    ((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7)),
   2*((-7*pow(t,6))/pow(dur,7) + (42*pow(t,5)*(1 - t/dur))/pow(dur,6))*((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur -
      (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
      (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) -
      (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (7*pow(t,6)*P[7*2+0])/pow(dur,7)),2*((-7*pow(t,6))/pow(dur,7) + (42*pow(t,5)*(1 - t/dur))/pow(dur,6))*
    ((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
      (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
      (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7)),
   (14*pow(t,6)*((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
        (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
        (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
        (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
   (14*pow(t,6)*((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
        (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
        (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
        (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow((-7*pow(1 - t/dur,6)*P[0*2+0])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+0])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) +
     (42*t*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) -
     (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
     (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (7*pow(t,6)*P[6*2+0])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (7*pow(t,6)*P[7*2+0])/pow(dur,7),2) +
   pow((-7*pow(1 - t/dur,6)*P[0*2+1])/dur - (42*t*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (7*pow(1 - t/dur,6)*P[1*2+1])/dur - (105*pow(t,2)*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) +
     (42*t*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) - (140*pow(t,3)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (105*pow(t,2)*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) -
     (105*pow(t,4)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (140*pow(t,3)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) - (42*pow(t,5)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
     (105*pow(t,4)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (7*pow(t,6)*P[6*2+1])/pow(dur,7) + (42*pow(t,5)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (7*pow(t,6)*P[7*2+1])/pow(dur,7),2);
  } else if(n==2) {
    if(grad.size()>0) {
      grad = vector<double> {(84*pow(1 - t/dur,5)*((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) +
        (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) +
        (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) +
        (42*pow(t,5)*P[5*2+0])/pow(dur,7) - (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) +
        (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (42*pow(t,5)*P[7*2+0])/pow(dur,7)))/pow(dur,2),
   (84*pow(1 - t/dur,5)*((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) +
        (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) +
        (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) +
        (42*pow(t,5)*P[5*2+1])/pow(dur,7) - (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) +
        (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (42*pow(t,5)*P[7*2+1])/pow(dur,7)))/pow(dur,2),
   2*((210*t*pow(1 - t/dur,4))/pow(dur,3) - (84*pow(1 - t/dur,5))/pow(dur,2))*
    ((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+0])/pow(dur,7)),2*((210*t*pow(1 - t/dur,4))/pow(dur,3) - (84*pow(1 - t/dur,5))/pow(dur,2))*
    ((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (42*pow(t,5)*P[5*2+1])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+1])/pow(dur,7)),2*((420*pow(t,2)*pow(1 - t/dur,3))/pow(dur,4) - (420*t*pow(1 - t/dur,4))/pow(dur,3) + (42*pow(1 - t/dur,5))/pow(dur,2))*
    ((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+0])/pow(dur,7)),2*((420*pow(t,2)*pow(1 - t/dur,3))/pow(dur,4) - (420*t*pow(1 - t/dur,4))/pow(dur,3) + (42*pow(1 - t/dur,5))/pow(dur,2))*
    ((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (42*pow(t,5)*P[5*2+1])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+1])/pow(dur,7)),2*((420*pow(t,3)*pow(1 - t/dur,2))/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3))/pow(dur,4) + (210*t*pow(1 - t/dur,4))/pow(dur,3))*
    ((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+0])/pow(dur,7)),2*((420*pow(t,3)*pow(1 - t/dur,2))/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3))/pow(dur,4) + (210*t*pow(1 - t/dur,4))/pow(dur,3))*
    ((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (42*pow(t,5)*P[5*2+1])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+1])/pow(dur,7)),2*((210*pow(t,4)*(1 - t/dur))/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2))/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3))/pow(dur,4))*
    ((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+0])/pow(dur,7)),2*((210*pow(t,4)*(1 - t/dur))/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2))/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3))/pow(dur,4))*
    ((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (42*pow(t,5)*P[5*2+1])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+1])/pow(dur,7)),2*((42*pow(t,5))/pow(dur,7) - (420*pow(t,4)*(1 - t/dur))/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2))/pow(dur,5))*
    ((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+0])/pow(dur,7)),2*((42*pow(t,5))/pow(dur,7) - (420*pow(t,4)*(1 - t/dur))/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2))/pow(dur,5))*
    ((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (42*pow(t,5)*P[5*2+1])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+1])/pow(dur,7)),2*((-84*pow(t,5))/pow(dur,7) + (210*pow(t,4)*(1 - t/dur))/pow(dur,6))*
    ((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+0])/pow(dur,7)),2*((-84*pow(t,5))/pow(dur,7) + (210*pow(t,4)*(1 - t/dur))/pow(dur,6))*
    ((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (42*pow(t,5)*P[5*2+1])/pow(dur,7) -
      (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) +
      (42*pow(t,5)*P[7*2+1])/pow(dur,7)),(84*pow(t,5)*((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) +
        (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) +
        (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) +
        (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) +
        (42*pow(t,5)*P[5*2+0])/pow(dur,7) - (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) +
        (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (42*pow(t,5)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
   (84*pow(t,5)*((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) +
        (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
        (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) +
        (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) +
        (42*pow(t,5)*P[5*2+1])/pow(dur,7) - (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) +
        (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (42*pow(t,5)*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow((42*pow(1 - t/dur,5)*P[0*2+0])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+0])/pow(dur,2) + (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
     (420*t*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+0])/pow(dur,2) + (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
     (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) + (210*pow(t,4)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
     (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (42*pow(t,5)*P[5*2+0])/pow(dur,7) -
     (420*pow(t,4)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (84*pow(t,5)*P[6*2+0])/pow(dur,7) + (210*pow(t,4)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
     (42*pow(t,5)*P[7*2+0])/pow(dur,7),2) + pow((42*pow(1 - t/dur,5)*P[0*2+1])/pow(dur,2) + (210*t*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (84*pow(1 - t/dur,5)*P[1*2+1])/pow(dur,2) +
     (420*pow(t,2)*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (420*t*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) + (42*pow(1 - t/dur,5)*P[2*2+1])/pow(dur,2) +
     (420*pow(t,3)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (840*pow(t,2)*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*t*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) +
     (210*pow(t,4)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (840*pow(t,3)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (420*pow(t,2)*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) +
     (42*pow(t,5)*P[5*2+1])/pow(dur,7) - (420*pow(t,4)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (420*pow(t,3)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (84*pow(t,5)*P[6*2+1])/pow(dur,7) +
     (210*pow(t,4)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (42*pow(t,5)*P[7*2+1])/pow(dur,7),2);
  } else if(n==3) {
    if(grad.size()>0) {
      grad = vector<double> {(-420*pow(1 - t/dur,4)*((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
        (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
        (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
        (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)))/
    pow(dur,3),(-420*pow(1 - t/dur,4)*((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
        (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
        (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
        (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)))/
    pow(dur,3),2*((-840*t*pow(1 - t/dur,3))/pow(dur,4) + (630*pow(1 - t/dur,4))/pow(dur,3))*
    ((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)),
   2*((-840*t*pow(1 - t/dur,3))/pow(dur,4) + (630*pow(1 - t/dur,4))/pow(dur,3))*
    ((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)),
   2*((-1260*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5) + (2520*t*pow(1 - t/dur,3))/pow(dur,4) - (630*pow(1 - t/dur,4))/pow(dur,3))*
    ((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)),
   2*((-1260*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5) + (2520*t*pow(1 - t/dur,3))/pow(dur,4) - (630*pow(1 - t/dur,4))/pow(dur,3))*
    ((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)),
   2*((-840*pow(t,3)*(1 - t/dur))/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5) - (2520*t*pow(1 - t/dur,3))/pow(dur,4) + (210*pow(1 - t/dur,4))/pow(dur,3))*
    ((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)),
   2*((-840*pow(t,3)*(1 - t/dur))/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5) - (2520*t*pow(1 - t/dur,3))/pow(dur,4) + (210*pow(1 - t/dur,4))/pow(dur,3))*
    ((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)),
   2*((-210*pow(t,4))/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur))/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5) + (840*t*pow(1 - t/dur,3))/pow(dur,4))*
    ((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)),
   2*((-210*pow(t,4))/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur))/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5) + (840*t*pow(1 - t/dur,3))/pow(dur,4))*
    ((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)),
   2*((630*pow(t,4))/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur))/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5))*
    ((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)),
   2*((630*pow(t,4))/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur))/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2))/pow(dur,5))*
    ((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
      (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
      (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
      (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)),
   2*((-630*pow(t,4))/pow(dur,7) + (840*pow(t,3)*(1 - t/dur))/pow(dur,6))*((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) +
      (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) - (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) -
      (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) - (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) -
      (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) + (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)),
   2*((-630*pow(t,4))/pow(dur,7) + (840*pow(t,3)*(1 - t/dur))/pow(dur,6))*((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) +
      (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) - (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) -
      (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) - (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
      (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) + (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)),
   (420*pow(t,4)*((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
        (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
        (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
        (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7)))/
    pow(dur,7),(420*pow(t,4)*((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
        (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
        (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
        (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
        (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7)))/
    pow(dur,7)};
    }
    return pow((-210*pow(1 - t/dur,4)*P[0*2+0])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+0])/pow(dur,3) -
     (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+0])/pow(dur,3) -
     (840*pow(t,3)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) +
     (210*pow(1 - t/dur,4)*P[3*2+0])/pow(dur,3) - (210*pow(t,4)*P[4*2+0])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
     (840*t*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (630*pow(t,4)*P[5*2+0])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
     (630*pow(t,4)*P[6*2+0])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (210*pow(t,4)*P[7*2+0])/pow(dur,7),2) +
   pow((-210*pow(1 - t/dur,4)*P[0*2+1])/pow(dur,3) - (840*t*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (630*pow(1 - t/dur,4)*P[1*2+1])/pow(dur,3) -
     (1260*pow(t,2)*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (2520*t*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) - (630*pow(1 - t/dur,4)*P[2*2+1])/pow(dur,3) -
     (840*pow(t,3)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (3780*pow(t,2)*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (2520*t*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) +
     (210*pow(1 - t/dur,4)*P[3*2+1])/pow(dur,3) - (210*pow(t,4)*P[4*2+1])/pow(dur,7) + (2520*pow(t,3)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (3780*pow(t,2)*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
     (840*t*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (630*pow(t,4)*P[5*2+1])/pow(dur,7) - (2520*pow(t,3)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (1260*pow(t,2)*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
     (630*pow(t,4)*P[6*2+1])/pow(dur,7) + (840*pow(t,3)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (210*pow(t,4)*P[7*2+1])/pow(dur,7),2);
  } else if(n==4) {
    if(grad.size()>0) {
      grad = vector<double> {(1680*pow(1 - t/dur,3)*((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) +
        (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) -
        (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) +
        (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) -
        (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
        (840*pow(t,3)*P[7*2+0])/pow(dur,7)))/pow(dur,4),(1680*pow(1 - t/dur,3)*
      ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
        (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
        (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
        (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
        (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)))/pow(dur,4),
   2*((2520*t*pow(1 - t/dur,2))/pow(dur,5) - (3360*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7)),
   2*((2520*t*pow(1 - t/dur,2))/pow(dur,5) - (3360*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)),
   2*((2520*pow(t,2)*(1 - t/dur))/pow(dur,6) - (10080*t*pow(1 - t/dur,2))/pow(dur,5) + (5040*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7)),
   2*((2520*pow(t,2)*(1 - t/dur))/pow(dur,6) - (10080*t*pow(1 - t/dur,2))/pow(dur,5) + (5040*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)),
   2*((840*pow(t,3))/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur))/pow(dur,6) + (15120*t*pow(1 - t/dur,2))/pow(dur,5) - (3360*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7)),
   2*((840*pow(t,3))/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur))/pow(dur,6) + (15120*t*pow(1 - t/dur,2))/pow(dur,5) - (3360*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)),
   2*((-3360*pow(t,3))/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur))/pow(dur,6) - (10080*t*pow(1 - t/dur,2))/pow(dur,5) + (840*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7)),
   2*((-3360*pow(t,3))/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur))/pow(dur,6) - (10080*t*pow(1 - t/dur,2))/pow(dur,5) + (840*pow(1 - t/dur,3))/pow(dur,4))*
    ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)),
   2*((5040*pow(t,3))/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur))/pow(dur,6) + (2520*t*pow(1 - t/dur,2))/pow(dur,5))*
    ((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7)),
   2*((5040*pow(t,3))/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur))/pow(dur,6) + (2520*t*pow(1 - t/dur,2))/pow(dur,5))*
    ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)),
   2*((-3360*pow(t,3))/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur))/pow(dur,6))*
    ((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7)),
   2*((-3360*pow(t,3))/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur))/pow(dur,6))*
    ((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
      (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)),
   (1680*pow(t,3)*((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) +
        (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) -
        (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) +
        (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) -
        (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
        (840*pow(t,3)*P[7*2+0])/pow(dur,7)))/pow(dur,7),(1680*pow(t,3)*((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) -
        (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) +
        (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) -
        (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
        (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
        (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow((840*pow(1 - t/dur,3)*P[0*2+0])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+0])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+0])/pow(dur,6) -
     (10080*t*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+0])/pow(dur,4) + (840*pow(t,3)*P[3*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
     (15120*t*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+0])/pow(dur,4) - (3360*pow(t,3)*P[4*2+0])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
     (10080*t*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+0])/pow(dur,4) + (5040*pow(t,3)*P[5*2+0])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
     (2520*t*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (3360*pow(t,3)*P[6*2+0])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (840*pow(t,3)*P[7*2+0])/pow(dur,7),2) +
   pow((840*pow(1 - t/dur,3)*P[0*2+1])/pow(dur,4) + (2520*t*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[1*2+1])/pow(dur,4) + (2520*pow(t,2)*(1 - t/dur)*P[2*2+1])/pow(dur,6) -
     (10080*t*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (5040*pow(1 - t/dur,3)*P[2*2+1])/pow(dur,4) + (840*pow(t,3)*P[3*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
     (15120*t*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (3360*pow(1 - t/dur,3)*P[3*2+1])/pow(dur,4) - (3360*pow(t,3)*P[4*2+1])/pow(dur,7) + (15120*pow(t,2)*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
     (10080*t*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (840*pow(1 - t/dur,3)*P[4*2+1])/pow(dur,4) + (5040*pow(t,3)*P[5*2+1])/pow(dur,7) - (10080*pow(t,2)*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
     (2520*t*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (3360*pow(t,3)*P[6*2+1])/pow(dur,7) + (2520*pow(t,2)*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (840*pow(t,3)*P[7*2+1])/pow(dur,7),2);
  } else if(n==5) {
    if(grad.size()>0) {
      grad = vector<double> {(-5040*pow(1 - t/dur,2)*((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) -
        (2520*pow(t,2)*P[2*2+0])/pow(dur,7) + (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) -
        (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) -
        (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) -
        (12600*pow(t,2)*P[6*2+0])/pow(dur,7) + (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)))/pow(dur,5),
   (-5040*pow(1 - t/dur,2)*((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) -
        (2520*pow(t,2)*P[2*2+1])/pow(dur,7) + (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) -
        (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) -
        (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) -
        (12600*pow(t,2)*P[6*2+1])/pow(dur,7) + (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)))/pow(dur,5),
   2*((-5040*t*(1 - t/dur))/pow(dur,6) + (12600*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)),
   2*((-5040*t*(1 - t/dur))/pow(dur,6) + (12600*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)),
   2*((-2520*pow(t,2))/pow(dur,7) + (25200*t*(1 - t/dur))/pow(dur,6) - (25200*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)),
   2*((-2520*pow(t,2))/pow(dur,7) + (25200*t*(1 - t/dur))/pow(dur,6) - (25200*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)),
   2*((12600*pow(t,2))/pow(dur,7) - (50400*t*(1 - t/dur))/pow(dur,6) + (25200*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)),
   2*((12600*pow(t,2))/pow(dur,7) - (50400*t*(1 - t/dur))/pow(dur,6) + (25200*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)),
   2*((-25200*pow(t,2))/pow(dur,7) + (50400*t*(1 - t/dur))/pow(dur,6) - (12600*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)),
   2*((-25200*pow(t,2))/pow(dur,7) + (50400*t*(1 - t/dur))/pow(dur,6) - (12600*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)),
   2*((25200*pow(t,2))/pow(dur,7) - (25200*t*(1 - t/dur))/pow(dur,6) + (2520*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)),
   2*((25200*pow(t,2))/pow(dur,7) - (25200*t*(1 - t/dur))/pow(dur,6) + (2520*pow(1 - t/dur,2))/pow(dur,5))*
    ((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
      (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
      (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
      (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
      (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)),
   2*((-12600*pow(t,2))/pow(dur,7) + (5040*t*(1 - t/dur))/pow(dur,6))*((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) +
      (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) + (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) +
      (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) + (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) +
      (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) + (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) +
      (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) + (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)),
   2*((-12600*pow(t,2))/pow(dur,7) + (5040*t*(1 - t/dur))/pow(dur,6))*((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) +
      (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) + (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) +
      (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) + (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) +
      (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) + (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) +
      (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) + (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)),
   (5040*pow(t,2)*((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
        (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
        (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
        (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
        (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7)))/pow(dur,7),
   (5040*pow(t,2)*((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
        (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
        (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
        (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
        (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow((-2520*pow(1 - t/dur,2)*P[0*2+0])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+0])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+0])/pow(dur,5) - (2520*pow(t,2)*P[2*2+0])/pow(dur,7) +
     (25200*t*(1 - t/dur)*P[2*2+0])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+0])/pow(dur,5) + (12600*pow(t,2)*P[3*2+0])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+0])/pow(dur,6) +
     (25200*pow(1 - t/dur,2)*P[3*2+0])/pow(dur,5) - (25200*pow(t,2)*P[4*2+0])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+0])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+0])/pow(dur,5) +
     (25200*pow(t,2)*P[5*2+0])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+0])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+0])/pow(dur,5) - (12600*pow(t,2)*P[6*2+0])/pow(dur,7) +
     (5040*t*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (2520*pow(t,2)*P[7*2+0])/pow(dur,7),2) +
   pow((-2520*pow(1 - t/dur,2)*P[0*2+1])/pow(dur,5) - (5040*t*(1 - t/dur)*P[1*2+1])/pow(dur,6) + (12600*pow(1 - t/dur,2)*P[1*2+1])/pow(dur,5) - (2520*pow(t,2)*P[2*2+1])/pow(dur,7) +
     (25200*t*(1 - t/dur)*P[2*2+1])/pow(dur,6) - (25200*pow(1 - t/dur,2)*P[2*2+1])/pow(dur,5) + (12600*pow(t,2)*P[3*2+1])/pow(dur,7) - (50400*t*(1 - t/dur)*P[3*2+1])/pow(dur,6) +
     (25200*pow(1 - t/dur,2)*P[3*2+1])/pow(dur,5) - (25200*pow(t,2)*P[4*2+1])/pow(dur,7) + (50400*t*(1 - t/dur)*P[4*2+1])/pow(dur,6) - (12600*pow(1 - t/dur,2)*P[4*2+1])/pow(dur,5) +
     (25200*pow(t,2)*P[5*2+1])/pow(dur,7) - (25200*t*(1 - t/dur)*P[5*2+1])/pow(dur,6) + (2520*pow(1 - t/dur,2)*P[5*2+1])/pow(dur,5) - (12600*pow(t,2)*P[6*2+1])/pow(dur,7) +
     (5040*t*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (2520*pow(t,2)*P[7*2+1])/pow(dur,7),2);
  } else if(n==6) {
    if(grad.size()>0) {
      grad = vector<double> {(10080*(1 - t/dur)*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) - (30240*t*P[2*2+0])/pow(dur,7) +
        (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) +
        (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (5040*t*P[7*2+0])/pow(dur,7)))/pow(dur,6),
   (10080*(1 - t/dur)*((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) +
        (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) + (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) +
        (75600*t*P[5*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)))/pow(dur,6),
   2*((5040*t)/pow(dur,7) - (30240*(1 - t/dur))/pow(dur,6))*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) -
      (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) +
      (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (5040*t*P[7*2+0])/pow(dur,7)),2*((5040*t)/pow(dur,7) - (30240*(1 - t/dur))/pow(dur,6))*
    ((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
      (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
      (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)),
   2*((-30240*t)/pow(dur,7) + (75600*(1 - t/dur))/pow(dur,6))*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) -
      (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) +
      (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (5040*t*P[7*2+0])/pow(dur,7)),2*((-30240*t)/pow(dur,7) + (75600*(1 - t/dur))/pow(dur,6))*
    ((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
      (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
      (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)),
   2*((75600*t)/pow(dur,7) - (100800*(1 - t/dur))/pow(dur,6))*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) -
      (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) +
      (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (5040*t*P[7*2+0])/pow(dur,7)),2*((75600*t)/pow(dur,7) - (100800*(1 - t/dur))/pow(dur,6))*
    ((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
      (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
      (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)),
   2*((-100800*t)/pow(dur,7) + (75600*(1 - t/dur))/pow(dur,6))*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) -
      (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) +
      (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (5040*t*P[7*2+0])/pow(dur,7)),2*((-100800*t)/pow(dur,7) + (75600*(1 - t/dur))/pow(dur,6))*
    ((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
      (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
      (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)),
   2*((75600*t)/pow(dur,7) - (30240*(1 - t/dur))/pow(dur,6))*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) -
      (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) +
      (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (5040*t*P[7*2+0])/pow(dur,7)),2*((75600*t)/pow(dur,7) - (30240*(1 - t/dur))/pow(dur,6))*
    ((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
      (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
      (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)),
   2*((-30240*t)/pow(dur,7) + (5040*(1 - t/dur))/pow(dur,6))*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) -
      (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) + (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) +
      (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) +
      (5040*t*P[7*2+0])/pow(dur,7)),2*((-30240*t)/pow(dur,7) + (5040*(1 - t/dur))/pow(dur,6))*
    ((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
      (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
      (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)),
   (10080*t*((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) - (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) +
        (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) -
        (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (5040*t*P[7*2+0])/pow(dur,7)))/pow(dur,7),
   (10080*t*((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
        (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
        (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow((5040*(1 - t/dur)*P[0*2+0])/pow(dur,6) + (5040*t*P[1*2+0])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+0])/pow(dur,6) - (30240*t*P[2*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+0])/pow(dur,6) +
     (75600*t*P[3*2+0])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+0])/pow(dur,6) - (100800*t*P[4*2+0])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+0])/pow(dur,6) + (75600*t*P[5*2+0])/pow(dur,7) -
     (30240*(1 - t/dur)*P[5*2+0])/pow(dur,6) - (30240*t*P[6*2+0])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+0])/pow(dur,6) + (5040*t*P[7*2+0])/pow(dur,7),2) +
   pow((5040*(1 - t/dur)*P[0*2+1])/pow(dur,6) + (5040*t*P[1*2+1])/pow(dur,7) - (30240*(1 - t/dur)*P[1*2+1])/pow(dur,6) - (30240*t*P[2*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[2*2+1])/pow(dur,6) +
     (75600*t*P[3*2+1])/pow(dur,7) - (100800*(1 - t/dur)*P[3*2+1])/pow(dur,6) - (100800*t*P[4*2+1])/pow(dur,7) + (75600*(1 - t/dur)*P[4*2+1])/pow(dur,6) + (75600*t*P[5*2+1])/pow(dur,7) -
     (30240*(1 - t/dur)*P[5*2+1])/pow(dur,6) - (30240*t*P[6*2+1])/pow(dur,7) + (5040*(1 - t/dur)*P[6*2+1])/pow(dur,6) + (5040*t*P[7*2+1])/pow(dur,7),2);
  } else if(n==7) {
    if(grad.size()>0) {
      grad = vector<double> {(-10080*((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-10080*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(70560*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(70560*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(-211680*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-211680*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(352800*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(352800*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(-352800*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-352800*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(211680*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(211680*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(-70560*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(-70560*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7),(10080*
      ((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
        (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7)))/pow(dur,7),(10080*
      ((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) - (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) -
        (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7)))/pow(dur,7)};
    }
    return pow((-5040*P[0*2+0])/pow(dur,7) + (35280*P[1*2+0])/pow(dur,7) - (105840*P[2*2+0])/pow(dur,7) + (176400*P[3*2+0])/pow(dur,7) - (176400*P[4*2+0])/pow(dur,7) + (105840*P[5*2+0])/pow(dur,7) -
     (35280*P[6*2+0])/pow(dur,7) + (5040*P[7*2+0])/pow(dur,7),2) + pow((-5040*P[0*2+1])/pow(dur,7) + (35280*P[1*2+1])/pow(dur,7) - (105840*P[2*2+1])/pow(dur,7) + (176400*P[3*2+1])/pow(dur,7) -
     (176400*P[4*2+1])/pow(dur,7) + (105840*P[5*2+1])/pow(dur,7) - (35280*P[6*2+1])/pow(dur,7) + (5040*P[7*2+1])/pow(dur,7),2);
  }
  if(grad.size() > 0) {
    grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  }
  return 0;
}
